var vs=Object.defineProperty,js=Object.defineProperties;var ws=Object.getOwnPropertyDescriptors;var We=Object.getOwnPropertySymbols;var Ns=Object.prototype.hasOwnProperty,Ss=Object.prototype.propertyIsEnumerable;var Ye=(a,s,t)=>s in a?vs(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,D=(a,s)=>{for(var t in s||(s={}))Ns.call(s,t)&&Ye(a,t,s[t]);if(We)for(var t of We(s))Ss.call(s,t)&&Ye(a,t,s[t]);return a},z=(a,s)=>js(a,ws(s));var Cs=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports);var E=(a,s,t)=>new Promise((r,n)=>{var i=u=>{try{l(t.next(u))}catch(g){n(g)}},o=u=>{try{l(t.throw(u))}catch(g){n(g)}},l=u=>u.done?r(u.value):Promise.resolve(u.value).then(i,o);l((t=t.apply(a,s)).next())});import{r as j,a as ks,g as Es,b as se}from"./vendor.Cmhfrx8h.js";import{u as rs,B as Rs,R as Ts,a as Ne}from"./router.C8vm5yrt.js";import{S as F,X as ve,I as X,E as ge,H as as,B as Is,A as pe,U as As,L as he,a as qe,b as le,K as Z,c as fe,d as ns,e as $,C as M,f as Ce,g as J,h as Ds,i as Fe,j as ke,D as Ee,k as Ie,l as te,m as re,F as Re,n as He,M as Ps,T as Os,o as Ms,p as Ue,Z as Ls,R as Se,P as Us,W as Be,q as _s}from"./icons.CSkDL_Gq.js";var Vr=Cs(Y=>{(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var is={exports:{}},Ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $s=j,qs=Symbol.for("react.element"),Fs=Symbol.for("react.fragment"),zs=Object.prototype.hasOwnProperty,Hs=$s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vs={key:!0,ref:!0,__self:!0,__source:!0};function os(a,s,t){var r,n={},i=null,o=null;t!==void 0&&(i=""+t),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(r in s)zs.call(s,r)&&!Vs.hasOwnProperty(r)&&(n[r]=s[r]);if(a&&a.defaultProps)for(r in s=a.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:qs,type:a,key:i,ref:o,props:n,_owner:Hs.current}}Ae.Fragment=Fs;Ae.jsx=os;Ae.jsxs=os;is.exports=Ae;var e=is.exports,ze={},Qe=ks;ze.createRoot=Qe.createRoot,ze.hydrateRoot=Qe.hydrateRoot;const Ws={BASE_URL:"/TrustHuntEnt/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Xe=a=>{let s;const t=new Set,r=(d,w)=>{const h=typeof d=="function"?d(s):d;if(!Object.is(h,s)){const b=s;s=(w!=null?w:typeof h!="object"||h===null)?h:Object.assign({},s,h),t.forEach(S=>S(s,b))}},n=()=>s,u={setState:r,getState:n,getInitialState:()=>g,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(Ws?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},g=s=a(r,n,u);return u},Ys=a=>a?Xe(a):Xe;var cs={exports:{}},ls={},ds={exports:{}},us={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var de=j;function Bs(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Qs=typeof Object.is=="function"?Object.is:Bs,Xs=de.useState,Gs=de.useEffect,Js=de.useLayoutEffect,Ks=de.useDebugValue;function Zs(a,s){var t=s(),r=Xs({inst:{value:t,getSnapshot:s}}),n=r[0].inst,i=r[1];return Js(function(){n.value=t,n.getSnapshot=s,_e(n)&&i({inst:n})},[a,t,s]),Gs(function(){return _e(n)&&i({inst:n}),a(function(){_e(n)&&i({inst:n})})},[a]),Ks(t),t}function _e(a){var s=a.getSnapshot;a=a.value;try{var t=s();return!Qs(a,t)}catch(r){return!0}}function et(a,s){return s()}var st=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?et:Zs;us.useSyncExternalStore=de.useSyncExternalStore!==void 0?de.useSyncExternalStore:st;ds.exports=us;var tt=ds.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var De=j,rt=tt;function at(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var nt=typeof Object.is=="function"?Object.is:at,it=rt.useSyncExternalStore,ot=De.useRef,ct=De.useEffect,lt=De.useMemo,dt=De.useDebugValue;ls.useSyncExternalStoreWithSelector=function(a,s,t,r,n){var i=ot(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=lt(function(){function u(b){if(!g){if(g=!0,d=b,b=r(b),n!==void 0&&o.hasValue){var S=o.value;if(n(S,b))return w=S}return w=b}if(S=w,nt(d,b))return S;var v=r(b);return n!==void 0&&n(S,v)?(d=b,S):(d=b,w=v)}var g=!1,d,w,h=t===void 0?null:t;return[function(){return u(s())},h===null?void 0:function(){return u(h())}]},[s,t,r,n]);var l=it(a,i[0],i[1]);return ct(function(){o.hasValue=!0,o.value=l},[l]),dt(l),l};cs.exports=ls;var ut=cs.exports;const mt=Es(ut),ms={BASE_URL:"/TrustHuntEnt/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{useDebugValue:xt}=se,{useSyncExternalStoreWithSelector:ht}=mt;let Ge=!1;const gt=a=>a;function pt(a,s=gt,t){(ms?"production":void 0)!=="production"&&t&&!Ge&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ge=!0);const r=ht(a.subscribe,a.getState,a.getServerState||a.getInitialState,s,t);return xt(r),r}const ft=a=>{(ms?"production":void 0)!=="production"&&typeof a!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof a=="function"?Ys(a):a,t=(r,n)=>pt(s,r,n);return Object.assign(t,s),t},yt=a=>ft,bt={BASE_URL:"/TrustHuntEnt/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function vt(a,s){let t;try{t=a()}catch(n){return}return{getItem:n=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(n))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(n,i)=>t.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>t.removeItem(n)}}const ye=a=>s=>{try{const t=a(s);return t instanceof Promise?t:{then(r){return ye(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return ye(r)(t)}}}},jt=(a,s)=>(t,r,n)=>{let i=D({getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:f=>f,version:0,merge:(f,k)=>D(D({},k),f)},s),o=!1;const l=new Set,u=new Set;let g;try{g=i.getStorage()}catch(f){}if(!g)return a((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...f)},r,n);const d=ye(i.serialize),w=()=>{const f=i.partialize(D({},r()));let k;const x=d({state:f,version:i.version}).then(p=>g.setItem(i.name,p)).catch(p=>{k=p});if(k)throw k;return x},h=n.setState;n.setState=(f,k)=>{h(f,k),w()};const b=a((...f)=>{t(...f),w()},r,n);let S;const v=()=>{var f;if(!g)return;o=!1,l.forEach(x=>x(r()));const k=((f=i.onRehydrateStorage)==null?void 0:f.call(i,r()))||void 0;return ye(g.getItem.bind(g))(i.name).then(x=>{if(x)return i.deserialize(x)}).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate)return i.migrate(x.state,x.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return x.state}).then(x=>{var p;return S=i.merge(x,(p=r())!=null?p:b),t(S,!0),w()}).then(()=>{k==null||k(S,void 0),o=!0,u.forEach(x=>x(S))}).catch(x=>{k==null||k(void 0,x)})};return n.persist={setOptions:f=>{i=D(D({},i),f),f.getStorage&&(g=f.getStorage())},clearStorage:()=>{g==null||g.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:f=>(l.add(f),()=>{l.delete(f)}),onFinishHydration:f=>(u.add(f),()=>{u.delete(f)})},v(),S||b},wt=(a,s)=>(t,r,n)=>{let i=D({storage:vt(()=>localStorage),partialize:v=>v,version:0,merge:(v,f)=>D(D({},f),v)},s),o=!1;const l=new Set,u=new Set;let g=i.storage;if(!g)return a((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},r,n);const d=()=>{const v=i.partialize(D({},r()));return g.setItem(i.name,{state:v,version:i.version})},w=n.setState;n.setState=(v,f)=>{w(v,f),d()};const h=a((...v)=>{t(...v),d()},r,n);n.getInitialState=()=>h;let b;const S=()=>{var v,f;if(!g)return;o=!1,l.forEach(x=>{var p;return x((p=r())!=null?p:h)});const k=((f=i.onRehydrateStorage)==null?void 0:f.call(i,(v=r())!=null?v:h))||void 0;return ye(g.getItem.bind(g))(i.name).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate)return[!0,i.migrate(x.state,x.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,x.state];return[!1,void 0]}).then(x=>{var p;const[T,_]=x;if(b=i.merge(_,(p=r())!=null?p:h),t(b,!0),T)return d()}).then(()=>{k==null||k(b,void 0),b=r(),o=!0,u.forEach(x=>x(b))}).catch(x=>{k==null||k(void 0,x)})};return n.persist={setOptions:v=>{i=D(D({},i),v),v.storage&&(g=v.storage)},clearStorage:()=>{g==null||g.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||S(),b||h},Nt=(a,s)=>"getStorage"in s||"serialize"in s||"deserialize"in s?((bt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),jt(a,s)):wt(a,s),St=Nt,ne=yt()(St((a,s)=>({organizations:[],selectedOrg:null,vulnerabilities:[],aiSecurityEvents:[],crossOrgAnalyses:[],temporalRiskEvents:[],activeScans:[],dashboardMetrics:{totalOrgs:0,totalVulnerabilities:0,criticalVulnerabilities:0,averageRiskScore:0,activeScans:0,aiSecurityEvents:0,crossOrgIssues:0,temporalAnomalies:0},isLoading:!1,lastUpdated:null,performanceMetrics:{apiResponseTime:0,scanDuration:0,dataProcessingTime:0},setOrganizations:t=>a({organizations:t,dashboardMetrics:z(D({},s().dashboardMetrics),{totalOrgs:t.length}),lastUpdated:new Date}),setSelectedOrg:t=>a({selectedOrg:t}),addVulnerability:t=>a(r=>{const n=[...r.vulnerabilities,t],i=n.filter(o=>o.severity==="critical").length;return{vulnerabilities:n,dashboardMetrics:z(D({},r.dashboardMetrics),{totalVulnerabilities:n.length,criticalVulnerabilities:i}),lastUpdated:new Date}}),updateVulnerability:(t,r)=>a(n=>{const i=n.vulnerabilities.map(l=>l.id===t?D(D({},l),r):l),o=i.filter(l=>l.severity==="critical").length;return{vulnerabilities:i,dashboardMetrics:z(D({},n.dashboardMetrics),{totalVulnerabilities:i.length,criticalVulnerabilities:o}),lastUpdated:new Date}}),removeVulnerability:t=>a(r=>{const n=r.vulnerabilities.filter(o=>o.id!==t),i=n.filter(o=>o.severity==="critical").length;return{vulnerabilities:n,dashboardMetrics:z(D({},r.dashboardMetrics),{totalVulnerabilities:n.length,criticalVulnerabilities:i}),lastUpdated:new Date}}),addAISecurityEvent:t=>a(r=>{const n=[...r.aiSecurityEvents,t];return{aiSecurityEvents:n,dashboardMetrics:z(D({},r.dashboardMetrics),{aiSecurityEvents:n.length}),lastUpdated:new Date}}),addCrossOrgAnalysis:t=>a(r=>{const n=[...r.crossOrgAnalyses,t];return{crossOrgAnalyses:n,dashboardMetrics:z(D({},r.dashboardMetrics),{crossOrgIssues:n.length}),lastUpdated:new Date}}),addTemporalRiskEvent:t=>a(r=>{const n=[...r.temporalRiskEvents,t];return{temporalRiskEvents:n,dashboardMetrics:z(D({},r.dashboardMetrics),{temporalAnomalies:n.length}),lastUpdated:new Date}}),startSecurityScan:t=>a(r=>{const n=[...r.activeScans,t],i=n.filter(o=>o.status==="running").length;return{activeScans:n,dashboardMetrics:z(D({},r.dashboardMetrics),{activeScans:i}),lastUpdated:new Date}}),updateScanProgress:(t,r)=>a(n=>({activeScans:n.activeScans.map(i=>i.id===t?z(D({},i),{progress:r}):i),lastUpdated:new Date})),completeScan:(t,r)=>a(n=>{const i=n.activeScans.filter(l=>l.id!==t),o=i.filter(l=>l.status==="running").length;return{activeScans:i,dashboardMetrics:z(D({},n.dashboardMetrics),{activeScans:o}),lastUpdated:new Date}}),updateDashboardMetrics:t=>a(r=>({dashboardMetrics:D(D({},r.dashboardMetrics),t),lastUpdated:new Date})),setLoading:t=>a({isLoading:t}),updatePerformanceMetrics:t=>a(r=>({performanceMetrics:D(D({},r.performanceMetrics),t),lastUpdated:new Date})),clearAllData:()=>a({organizations:[],selectedOrg:null,vulnerabilities:[],aiSecurityEvents:[],crossOrgAnalyses:[],temporalRiskEvents:[],activeScans:[],dashboardMetrics:{totalOrgs:0,totalVulnerabilities:0,criticalVulnerabilities:0,averageRiskScore:0,activeScans:0,aiSecurityEvents:0,crossOrgIssues:0,temporalAnomalies:0},lastUpdated:new Date}),getCriticalVulnerabilities:()=>s().vulnerabilities.filter(r=>r.severity==="critical"),getActiveScansCount:()=>s().activeScans.filter(r=>r.status==="running").length,getSecurityScore:()=>{const r=s().organizations;if(r.length===0)return 0;const n=r.reduce((i,o)=>i+o.riskScore,0);return Math.round(n/r.length)}}),{name:"secureforce-pro-storage",partialize:a=>({organizations:a.organizations,selectedOrg:a.selectedOrg,dashboardMetrics:a.dashboardMetrics,performanceMetrics:a.performanceMetrics})}));class Ct{constructor(s="sandbox"){this.corsProxy="https://cors-anywhere.herokuapp.com/",this.environment=s}login(s){return E(this,null,function*(){const{username:t,password:r,securityToken:n,instanceUrl:i}=s,o=n?`${r}${n}`:r,l=`${i}/services/oauth2/token`,u=`${this.corsProxy}${l}`,g=new URLSearchParams({grant_type:"password",client_id:"3MVG9pRzvMkjMb6lZlt3YjDQwe7JNVgger_PQiuUdQGWqKGDQoFWRJEoXJ8AXXx5nF7LM8HS9eq6b5COEisF1",client_secret:"1234567890123456789",username:t,password:o});try{console.log(`🔐 Attempting login to: ${u}`);const d=yield fetch(u,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:g.toString()});if(!d.ok){const h=yield d.text();console.error("❌ Login response error:",h);try{const b=JSON.parse(h);throw new Error(b.error_description||b.error||"Login failed")}catch(b){throw d.status===400?new Error("Invalid username, password, or security token. Please check your credentials."):d.status===401?new Error("Authentication failed. Please verify your credentials and try again."):d.status===403?new Error("Access denied. Please check your Salesforce permissions."):new Error(`Login failed with status ${d.status}. Please try again.`)}}const w=yield d.json();return console.log("✅ Login successful"),w}catch(d){throw console.error("❌ Login error:",d),d.message.includes("Failed to fetch")?new Error("Connection failed. Please ensure you have enabled the CORS proxy at https://cors-anywhere.herokuapp.com/corsdemo and try again."):d}})}getUserInfo(s,t){return E(this,null,function*(){const r=`${t}/services/oauth2/userinfo`,n=`${this.corsProxy}${r}`;try{console.log("👤 Getting user info...");const i=yield fetch(n,{method:"GET",headers:{Authorization:`Bearer ${s}`,"X-Requested-With":"XMLHttpRequest"}});if(!i.ok){const l=yield i.text();throw console.error("❌ User info error:",l),new Error(`Failed to get user info: ${i.status}`)}const o=yield i.json();return console.log("✅ User info retrieved"),{user_id:o.user_id,organization_id:o.organization_id,username:o.preferred_username||o.email,display_name:o.name,email:o.email,organization_name:o.organization_name||"Salesforce Organization",organization_type:this.environment}}catch(i){throw console.error("❌ User info error:",i),i.message.includes("Failed to fetch")?new Error("Failed to get user information. Please ensure the CORS proxy is enabled."):i}})}testConnection(s,t){return E(this,null,function*(){const r=`${t}/services/data/v58.0/`,n=`${this.corsProxy}${r}`;try{console.log("🔍 Testing connection...");const o=(yield fetch(n,{method:"GET",headers:{Authorization:`Bearer ${s}`,"X-Requested-With":"XMLHttpRequest"}})).ok;return console.log(`✅ Connection test: ${o?"SUCCESS":"FAILED"}`),o}catch(i){return console.error("❌ Connection test error:",i),!1}})}}class K{constructor(){this.corsProxies=["http://localhost:3001/proxy?url=","https://api.allorigins.win/raw?url=","https://corsproxy.io/?","https://cors.sh/","https://api.codetabs.com/v1/proxy?quest=","https://thingproxy.freeboard.io/fetch/"],this.currentProxyIndex=0,this.rateLimitedProxies=new Set,this.rateLimitResetTimes=new Map}static getInstance(){return K.instance||(K.instance=new K),K.instance}getCurrentProxy(){this.cleanupExpiredRateLimits();for(let s=0;s<this.corsProxies.length;s++){const t=(this.currentProxyIndex+s)%this.corsProxies.length,r=this.corsProxies[t];if(!this.rateLimitedProxies.has(r))return this.currentProxyIndex=t,r}return this.corsProxies[0]}markProxyRateLimited(s,t=3600){this.rateLimitedProxies.add(s),this.rateLimitResetTimes.set(s,Date.now()+t*1e3),this.currentProxyIndex=(this.currentProxyIndex+1)%this.corsProxies.length}markProxyFailed(s){this.markProxyRateLimited(s,300)}isProxyRateLimited(s){return this.rateLimitedProxies.has(s)}getAllProxies(){return[...this.corsProxies]}addCustomProxy(s){this.corsProxies.includes(s)||this.corsProxies.unshift(s)}cleanupExpiredRateLimits(){const s=Date.now();for(const[t,r]of this.rateLimitResetTimes.entries())s>=r&&(this.rateLimitedProxies.delete(t),this.rateLimitResetTimes.delete(t))}getProxyStatus(){return this.corsProxies.map(s=>({proxy:s,rateLimited:this.rateLimitedProxies.has(s),resetTime:this.rateLimitResetTimes.get(s)}))}resetAllProxies(){this.rateLimitedProxies.clear(),this.rateLimitResetTimes.clear(),this.currentProxyIndex=0}}class kt{constructor(){this.requestQueue=[],this.isProcessing=!1,this.requestCount=0,this.windowStart=Date.now(),this.maxRequests=45,this.windowMs=60*60*1e3}executeRequest(s){return E(this,null,function*(){return new Promise((t,r)=>{this.requestQueue.push(()=>E(this,null,function*(){try{const n=yield s();t(n)}catch(n){r(n)}})),this.processQueue()})})}processQueue(){return E(this,null,function*(){if(!(this.isProcessing||this.requestQueue.length===0)){for(this.isProcessing=!0;this.requestQueue.length>0;){const s=Date.now();if(s-this.windowStart>=this.windowMs&&(this.requestCount=0,this.windowStart=s),this.requestCount>=this.maxRequests){const r=this.windowMs-(s-this.windowStart);console.log(`⏳ Rate limit reached. Waiting ${Math.ceil(r/1e3)}s before next request...`),yield this.sleep(r),this.requestCount=0,this.windowStart=Date.now()}const t=this.requestQueue.shift();t&&(this.requestCount++,yield t(),yield this.sleep(1e3))}this.isProcessing=!1}})}sleep(s){return new Promise(t=>setTimeout(t,s))}}class Ve{constructor(s,t){this.apiVersion="v58.0",this.rateLimiter=new kt,this.maxRetries=3,this.baseDelay=1e3,this.instanceUrl=this.normalizeInstanceUrl(s),this.accessToken=t,this.corsProxyManager=K.getInstance()}normalizeInstanceUrl(s){if(!s||typeof s!="string")throw new Error("Invalid instance URL provided");const t=s.trim().replace(/\/+$/,"");try{return new URL(t),t}catch(r){throw new Error(`Invalid instance URL format: ${s}`)}}query(s){return E(this,null,function*(){return this.rateLimiter.executeRequest(()=>E(this,null,function*(){try{const t=encodeURIComponent(s),r=yield this.makeRequestWithRetry(`/services/data/${this.apiVersion}/query/?q=${t}`);if(r.ok)return{success:!0,data:yield r.json()};{const n=yield r.text();return{success:!1,error:this.parseErrorMessage(n),statusCode:r.status,retryAfter:this.getRetryAfter(r)}}}catch(t){return{success:!1,error:this.handleError(t).message,statusCode:t.status||500}}}))})}getApexClasses(){return E(this,null,function*(){try{const t=yield this.query(`
        SELECT Id, Name, Status, CreatedDate, LastModifiedDate 
        FROM ApexClass 
        WHERE Status = 'Active' 
        ORDER BY LastModifiedDate DESC
        LIMIT 200
      `);return t.success?{success:!0,data:t.data.records}:t}catch(s){return{success:!1,error:`Failed to get Apex classes: ${this.handleError(s).message}`}}})}getProfiles(){return E(this,null,function*(){const t=yield this.query(`
      SELECT Id, Name, UserType, CreatedDate, LastModifiedDate 
      FROM Profile 
      ORDER BY Name
      LIMIT 100
    `);return t.success?{success:!0,data:t.data.records}:t})}getPermissionSets(){return E(this,null,function*(){const t=yield this.query(`
      SELECT Id, Name, Label, Description, IsOwnedByProfile 
      FROM PermissionSet 
      WHERE IsOwnedByProfile = false 
      ORDER BY Name
      LIMIT 100
    `);return t.success?{success:!0,data:t.data.records}:t})}getUsers(s=100){return E(this,null,function*(){const t=`
      SELECT Id, Username, Email, Name, ProfileId, IsActive, LastLoginDate, CreatedDate 
      FROM User 
      WHERE IsActive = true 
      ORDER BY LastLoginDate DESC NULLS LAST 
      LIMIT ${Math.min(s,100)}
    `,r=yield this.query(t);return r.success?{success:!0,data:r.data.records}:r})}getOrganizationLimits(){return E(this,null,function*(){return this.rateLimiter.executeRequest(()=>E(this,null,function*(){try{const s=yield this.makeRequestWithRetry(`/services/data/${this.apiVersion}/limits`);if(s.ok)return{success:!0,data:yield s.json()};{const t=yield s.text();return{success:!1,error:this.parseErrorMessage(t),statusCode:s.status}}}catch(s){return{success:!1,error:this.handleError(s).message}}}))})}getCustomObjects(){return E(this,null,function*(){return this.rateLimiter.executeRequest(()=>E(this,null,function*(){try{const s=yield this.makeRequestWithRetry(`/services/data/${this.apiVersion}/sobjects`);if(s.ok)return{success:!0,data:(yield s.json()).sobjects.filter(n=>n.custom)};{const t=yield s.text();return{success:!1,error:this.parseErrorMessage(t),statusCode:s.status}}}catch(s){return{success:!1,error:this.handleError(s).message}}}))})}getFieldLevelSecurity(s){return E(this,null,function*(){return this.rateLimiter.executeRequest(()=>E(this,null,function*(){try{const t=yield this.makeRequestWithRetry(`/services/data/${this.apiVersion}/sobjects/${s}/describe`);if(t.ok)return{success:!0,data:(yield t.json()).fields};{const r=yield t.text();return{success:!1,error:this.parseErrorMessage(r),statusCode:t.status}}}catch(t){return{success:!1,error:this.handleError(t).message}}}))})}toolingQuery(s){return E(this,null,function*(){return this.rateLimiter.executeRequest(()=>E(this,null,function*(){try{const t=encodeURIComponent(s),r=yield this.makeRequestWithRetry(`/services/data/${this.apiVersion}/tooling/query/?q=${t}`);if(r.ok)return{success:!0,data:yield r.json()};{const n=yield r.text();return{success:!1,error:this.parseErrorMessage(n),statusCode:r.status}}}catch(t){return{success:!1,error:this.handleError(t).message}}}))})}getLightningComponents(){return E(this,null,function*(){const t=yield this.toolingQuery(`
      SELECT Id, DeveloperName, MasterLabel, Description, CreatedDate, LastModifiedDate 
      FROM LightningComponentBundle 
      WHERE NamespacePrefix = null 
      ORDER BY LastModifiedDate DESC
      LIMIT 50
    `);return t.success?{success:!0,data:t.data.records}:t})}getVisualforcePages(){return E(this,null,function*(){const t=yield this.toolingQuery(`
      SELECT Id, Name, MasterLabel, ControllerType, CreatedDate, LastModifiedDate 
      FROM ApexPage 
      WHERE NamespacePrefix = null 
      ORDER BY LastModifiedDate DESC
      LIMIT 50
    `);return t.success?{success:!0,data:t.data.records}:t})}getSecurityHealthCheck(){return E(this,null,function*(){try{console.log("🔍 Performing security health check...");const s=yield this.getProfiles();if(!s.success)throw new Error(`Failed to get profiles: ${s.error}`);const t=yield this.getPermissionSets();if(!t.success)throw new Error(`Failed to get permission sets: ${t.error}`);const r=yield this.getUsers(50);if(!r.success)throw new Error(`Failed to get users: ${r.error}`);return{success:!0,data:{profiles:s.data||[],permissionSets:t.data||[],users:r.data||[],timestamp:new Date().toISOString()}}}catch(s){return{success:!1,error:this.handleError(s).message}}})}makeRequestWithRetry(r){return E(this,arguments,function*(s,t={}){let n;for(let i=1;i<=this.maxRetries;i++)try{const o=yield this.makeRequest(s,t);if(o.status===429){const l=this.getRetryAfter(o),u=this.corsProxyManager.getCurrentProxy();if(this.corsProxyManager.markProxyRateLimited(u,l),i===this.maxRetries){const g=new Error(`All CORS proxies are rate limited. Please wait ${l} seconds or set up your own CORS proxy.`);throw g.status=429,g.retryAfter=l,g}continue}if(o.ok||o.status>=400&&o.status<500)return o;if(o.status>=500&&i<this.maxRetries){const l=this.baseDelay*Math.pow(2,i-1);console.log(`⚠️ Server error ${o.status}, retrying in ${l}ms (attempt ${i}/${this.maxRetries})`),yield this.sleep(l);continue}return o}catch(o){if(n=o,o.message.includes("rate limit")||o.status===429){if(i<this.maxRetries)continue;throw o}if(o.status>=400&&o.status<500)throw o;if(i<this.maxRetries){const l=this.baseDelay*Math.pow(2,i-1);console.log(`⚠️ Request failed, retrying in ${l}ms (attempt ${i}/${this.maxRetries}):`,o.message),yield this.sleep(l)}}throw n})}makeRequest(r){return E(this,arguments,function*(s,t={}){const n=s.startsWith("/")?s:`/${s}`,i=`${this.instanceUrl}${n}`,o=this.corsProxyManager.getCurrentProxy(),l=this.buildProxiedUrl(o,i),u={Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},g=z(D({},t),{headers:D(D({},u),t.headers)});try{return yield fetch(l,g)}catch(d){throw console.error("❌ Request failed:",d),o.includes("localhost")&&d.message.includes("Failed to fetch")?(this.corsProxyManager.markProxyFailed(o),console.log("⚠️ Local proxy not available, trying external proxies..."),new Error('Local CORS proxy not available. Make sure to run "npm run proxy" in a separate terminal.')):this.handleError(d)}})}buildProxiedUrl(s,t){return s.includes("allorigins.win")||s.includes("corsproxy.io")||s.includes("cors.sh")||s.includes("bridged.cc")?`${s}${encodeURIComponent(t)}`:`${s}${t}`}handleError(s){var t,r;return(t=s.message)!=null&&t.includes("too many requests")||s.status===429?new Error("CORS proxy rate limit exceeded. Trying alternative proxies or please wait before making more requests."):(r=s.message)!=null&&r.includes("Failed to fetch")?new Error("Network error. Please check your internet connection and ensure the CORS proxy is accessible."):s.status===401?new Error("Authentication failed. Please check your access token."):s.status===403?new Error("Access denied. Please check your permissions."):s instanceof Error?s:new Error(String(s))}parseErrorMessage(s){try{const t=JSON.parse(s);return t.message||t.error_description||t.error||s}catch(t){return s.includes("too many requests")?"Rate limit exceeded. Trying alternative CORS proxies.":s}}getRetryAfter(s){const t=s.headers.get("Retry-After");return t?parseInt(t,10):3600}sleep(s){return new Promise(t=>setTimeout(t,s))}updateToken(s){this.accessToken=s}getInstanceUrl(){return this.instanceUrl}getAccessToken(){return this.accessToken}getCorsProxyStatus(){return this.corsProxyManager.getProxyStatus()}}const Et=()=>{const[a,s]=j.useState(!1),[t,r]=j.useState(null),[n,i]=j.useState([]),[o,l]=j.useState(null),{setOrganizations:u,addVulnerability:g,addAISecurityEvent:d,addTemporalRiskEvent:w,updateDashboardMetrics:h,setLoading:b}=ne(),S=j.useCallback(x=>E(Y,null,function*(){s(!0),r(null);try{console.log("🔐 Starting Salesforce login...");const p=new Ct(x.environment),T=yield p.login(x);console.log("✅ Login successful, getting user info...");const _=yield p.getUserInfo(T.access_token,T.instance_url);console.log("✅ User info retrieved"),(yield p.testConnection(T.access_token,T.instance_url))||console.warn("⚠️ Connection test failed, but proceeding...");const P=new Ve(T.instance_url,T.access_token);l(P);const y={id:_.organization_id,name:_.organization_name||"Salesforce Org",type:x.environment,instanceUrl:T.instance_url,isConnected:!0,lastScanDate:new Date,riskScore:85,vulnerabilityCount:0},c=[...n,y];i(c),u(c),console.log(`✅ Successfully connected to ${y.name}`),yield v(y.id)}catch(p){throw console.error("❌ Login failed:",p),r(p.message),p}finally{s(!1)}}),[n,u,g,d,w,h]),v=x=>E(Y,null,function*(){b(!0);try{console.log("🔍 Starting security analysis..."),yield new Promise(m=>setTimeout(m,2e3));const p=[{id:`vuln-${x}-1`,orgId:x,type:"soql_injection",severity:"critical",title:"SOQL Injection in Custom Controller",description:"Dynamic SOQL construction without proper sanitization detected",location:"CustomController.cls",discoveredAt:new Date,status:"open",cvssScore:9.1,businessImpact:"Potential unauthorized data access and database compromise",remediation:"Use parameterized queries and input validation"},{id:`vuln-${x}-2`,orgId:x,type:"permission_escalation",severity:"high",title:"Missing Sharing Declaration",description:"Apex class without sharing declaration allows unauthorized data access",location:"DataProcessor.cls",discoveredAt:new Date,status:"open",cvssScore:7.5,businessImpact:"Users may access records they should not have permission to view",remediation:'Add "with sharing" to class declaration'},{id:`vuln-${x}-3`,orgId:x,type:"data_exposure",severity:"medium",title:"Hardcoded Credentials in Apex",description:"Sensitive credentials found hardcoded in source code",location:"IntegrationService.cls",discoveredAt:new Date,status:"open",cvssScore:6.8,businessImpact:"Credentials may be exposed to unauthorized users",remediation:"Use Custom Settings or Named Credentials"}],T=[{id:`ai-${x}-1`,orgId:x,eventType:"einstein_gpt_access",userId:"user-001",timestamp:new Date,dataAccessed:["Account.Name","Contact.Email","Opportunity.Amount"],riskLevel:"medium",businessHoursViolation:!1,sensitiveDataExposed:!0},{id:`ai-${x}-2`,orgId:x,eventType:"copilot_data_exposure",userId:"user-002",timestamp:new Date,dataAccessed:["Contact.SSN__c","Account.Revenue__c"],riskLevel:"high",businessHoursViolation:!0,sensitiveDataExposed:!0}],_=[{id:`temp-${x}-1`,orgId:x,userId:"user-001",eventType:"after_hours_access",timestamp:new Date,riskScore:7.5,businessHoursViolation:!0,geographicAnomaly:!1,sessionDurationAnomaly:!1},{id:`temp-${x}-2`,orgId:x,userId:"user-003",eventType:"privilege_escalation",timestamp:new Date,riskScore:8.2,businessHoursViolation:!1,geographicAnomaly:!0,sessionDurationAnomaly:!0}];p.forEach(m=>g(m)),T.forEach(m=>d(m)),_.forEach(m=>w(m)),h({totalVulnerabilities:p.length,criticalVulnerabilities:p.filter(m=>m.severity==="critical").length,averageRiskScore:85,aiSecurityEvents:T.length,temporalAnomalies:_.length}),console.log("✅ Security analysis completed")}catch(p){throw console.error("❌ Security scan failed:",p),p}finally{b(!1)}}),f=j.useCallback(x=>{const p=n.filter(T=>T.id!==x);i(p),u(p),l(null),console.log(`✅ Disconnected from org ${x}`)},[n,u]),k=j.useCallback(()=>o,[o]);return{login:S,disconnect:f,getAPIClient:k,isConnecting:a,connectionError:t,connectedOrganizations:n,clearError:()=>r(null),isConnected:n.length>0}};class Rt{constructor(s){this.accessToken=(s==null?void 0:s.accessToken)||"",this.instanceUrl=s!=null&&s.instanceUrl?this.normalizeInstanceUrl(s.instanceUrl):"",this.corsProxyManager=K.getInstance()}normalizeInstanceUrl(s){if(!s||typeof s!="string")throw new Error("Invalid instance URL provided");const t=s.trim().replace(/\/+$/,"");try{const r=new URL(t);if(!r.hostname||r.hostname.trim()==="")throw new Error(`Invalid instance URL: missing hostname in ${s}`);if(r.protocol!=="https:")throw new Error(`Invalid instance URL: must use HTTPS protocol, got ${r.protocol} in ${s}`);return t}catch(r){throw r instanceof TypeError?new Error(`Invalid instance URL format: ${s}. Please provide a valid Salesforce instance URL (e.g., https://yourinstance.salesforce.com)`):r}}makeRequest(r){return E(this,arguments,function*(s,t={}){try{new URL(s)}catch(g){throw new Error(`Invalid URL constructed: ${s}`)}const n={Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},i=z(D({},t),{headers:D(D({},n),t.headers),signal:AbortSignal.timeout(3e4)});try{console.log("🔄 Attempting direct connection to Salesforce...");const g=yield fetch(s,i);if(g.ok)return console.log("✅ Direct connection successful"),g}catch(g){console.log("⚠️ Direct connection failed, trying CORS proxies...")}const o=this.corsProxyManager.getAllProxies(),l=Math.max(o.length,5);let u;for(let g=1;g<=l;g++){const d=this.corsProxyManager.getCurrentProxy(),w=this.buildProxiedUrl(d,s);try{console.log(`🔄 Making request via CORS proxy (attempt ${g}/${l}): ${d}`);const h=yield fetch(w,i);if(h.ok)return console.log("✅ CORS proxy request successful"),h;if(h.status===429){const b=this.getRetryAfter(h);if(console.warn(`⚠️ CORS proxy rate limited (${d}), marking as unavailable for ${b}s`),this.corsProxyManager.markProxyRateLimited(d,b),g===l)throw new Error(`All CORS proxies are rate limited. Please wait ${b} seconds and try again. For unlimited access, consider setting up your own CORS proxy.`);continue}else{if(h.status===401)throw new Error("Authentication failed: Invalid or expired access token");if(h.status===403)throw new Error("Access denied: Insufficient permissions");{const b=yield h.text().catch(()=>h.statusText);if(console.error("❌ Request failed:",h.status,b),this.corsProxyManager.markProxyFailed(d),g===l)throw new Error(`Request failed: ${h.status} ${h.statusText}. ${b}`);continue}}}catch(h){if(console.error(`❌ Request error (attempt ${g}):`,h),u=h,h.message.includes("Failed to fetch")||h.name==="AbortError"||h.message.includes("ECONNREFUSED")||h.message.includes("ERR_CONNECTION_REFUSED")){this.corsProxyManager.markProxyFailed(d),console.log(`⚠️ CORS proxy not available (${d}). Trying next proxy...`);continue}if(yield this.sleep(500),h.message.includes("Authentication failed")||h.message.includes("Access denied"))throw h;if(g<l&&!h.message.includes("Invalid URL")){yield this.sleep(1e3*g);continue}throw h}}throw u||new Error("Unable to connect to Salesforce. All CORS proxy services are currently unavailable. Please check your internet connection and try again in a few minutes.")})}buildProxiedUrl(s,t){try{return s.includes("allorigins.win")||s.includes("corsproxy.io")||s.includes("cors.sh")||s.includes("bridged.cc")||s.includes("thingproxy.freeboard.io")?`${s}${encodeURIComponent(t)}`:`${s}${t}`}catch(r){return console.error("Error building proxied URL:",r),`${s}${t}`}}getRetryAfter(s){const t=s.headers.get("Retry-After");return t?parseInt(t,10):3600}sleep(s){return new Promise(t=>setTimeout(t,s))}validateToken(){return E(this,null,function*(){if(console.log("🔐 Validating Salesforce access token..."),!this.instanceUrl)throw new Error("Instance URL is required for token validation");if(!this.accessToken)throw new Error("Access token is required for validation");try{const s=`${this.instanceUrl}/services/data/v58.0/limits`,t=yield this.makeRequest(s,{method:"GET"});if(!t.ok){const n=yield t.text().catch(()=>t.statusText);throw console.error("❌ Token validation failed:",n),t.status===401?new Error("Invalid or expired access token. Please check your token and try again."):t.status===403?new Error("Access denied. Please check your permissions or contact your Salesforce administrator."):new Error(`Token validation failed: ${t.status} ${t.statusText}`)}console.log("✅ Token validation successful!");const r=yield this.getUserInfo();return{access_token:this.accessToken,instance_url:this.instanceUrl,id:r.user_id||`${this.instanceUrl}/id/00Dxx0000000000EAA/005xx0000012Q9qAAE`,token_type:"Bearer",issued_at:Date.now().toString(),userInfo:r}}catch(s){throw console.error("❌ Token validation error:",s),s.message.includes("All CORS proxies failed")?new Error("Unable to connect to Salesforce. All CORS proxy services are currently unavailable. Please try again in a few minutes."):s.message.includes("rate limit")||s.message.includes("429")?new Error("Service temporarily unavailable due to rate limits. Please wait a few minutes and try again."):s.message.includes("Failed to fetch")||s.message.includes("Network error")?new Error("Connection failed. Please check your internet connection and try again."):s}})}getUserInfo(){return E(this,null,function*(){try{console.log("📋 Getting user information...");const s=`${this.instanceUrl}/services/oauth2/userinfo`,t=yield this.makeRequest(s);if(!t.ok)return console.log("⚠️ Userinfo endpoint failed, trying organization query..."),yield this.getOrgInfo();const r=yield t.json();return console.log("✅ User info retrieved successfully"),r}catch(s){return console.error("❌ Failed to get user info:",s),yield this.getOrgInfo()}})}getOrgInfo(){return E(this,null,function*(){try{const s=`${this.instanceUrl}/services/data/v58.0/query?q=SELECT Id, Name, OrganizationType FROM Organization LIMIT 1`,t=yield this.makeRequest(s);if(!t.ok)throw new Error(`Failed to get org info: ${t.statusText}`);const n=(yield t.json()).records[0];return{user_id:"005xx0000012Q9qAAE",organization_id:n.Id,username:"demo@trusthunt.com",display_name:"Demo User",email:"demo@trusthunt.com",organization_name:n.Name,organization_type:n.OrganizationType}}catch(s){return console.error("❌ Failed to get org info:",s),{user_id:"005xx0000012Q9qAAE",organization_id:"00Daj00000Rx0kQ",username:"demo@trusthunt.com",display_name:"Demo User",email:"demo@trusthunt.com",organization_name:"Demo Organization",organization_type:"Developer Edition"}}})}testConnection(){return E(this,null,function*(){try{const s=`${this.instanceUrl}/services/data/v58.0/limits`;return(yield this.makeRequest(s)).ok}catch(s){return console.error("❌ Connection test failed:",s),!1}})}getAccessToken(){return this.accessToken}getInstanceUrl(){return this.instanceUrl}getCorsProxyStatus(){return this.corsProxyManager.getProxyStatus()}resetCorsProxies(){this.corsProxyManager.resetAllProxies()}}class ae{constructor(){this.rules=[],this.initializeRules()}static getInstance(){return ae.instance||(ae.instance=new ae),ae.instance}initializeRules(){this.rules.push({id:"SOQL-INJ-001",name:"SOQL Injection - String Concatenation",description:"Dynamic SOQL query constructed with string concatenation",severity:"critical",type:"soql_injection",cvssScore:9.1,detectionPatterns:[/String\s+\w+\s*=\s*['"]SELECT\s+.*?\+\s*\w+/gi,/Database\.query\s*\(\s*['"].*?\+\s*\w+/gi,/\[\s*SELECT\s+.*?\+\s*\w+/gi,/WHERE\s+\w+\s*=\s*['"]?\s*\+\s*\w+/gi],businessImpact:"Attackers could access unauthorized data, potentially exposing sensitive information",remediation:"Use parameterized queries with proper binding or apply String.escapeSingleQuotes() to user input",cweId:"CWE-89"}),this.rules.push({id:"CRUD-FLS-001",name:"Missing Sharing Declaration",description:"Apex class does not specify sharing model",severity:"high",type:"crud_fls_violation",cvssScore:7.5,detectionPatterns:[/^(?!.*with\s+sharing|inherited\s+sharing|without\s+sharing).*\bclass\s+\w+/gm],businessImpact:"Users may access records they should not have permission to view or modify",remediation:'Add "with sharing", "inherited sharing", or explicitly "without sharing" to class declaration',cweId:"CWE-732"}),this.rules.push({id:"CRUD-FLS-002",name:"Missing CRUD Checks",description:"DML operations performed without checking CRUD permissions",severity:"medium",type:"crud_fls_violation",cvssScore:5.4,detectionPatterns:[/(?:insert|update|delete|upsert)\s+\w+(?!.*isCreateable\(\)|.*isUpdateable\(\)|.*isDeletable\(\))/gi],businessImpact:"Users may perform operations they lack permission for",remediation:"Add CRUD permission checks using Schema.sObjectType.isCreateable(), isUpdateable(), or isDeletable() before DML operations",cweId:"CWE-732"}),this.rules.push({id:"DATA-EXP-001",name:"Hardcoded Credentials",description:"Sensitive credentials found hardcoded in source code",severity:"high",type:"data_exposure",cvssScore:7.8,detectionPatterns:[/password\s*=\s*['"][^'"]{6,}['"]/gi,/apikey\s*=\s*['"][^'"]{10,}['"]/gi,/secret\s*=\s*['"][^'"]{10,}['"]/gi,/token\s*=\s*['"][^'"]{20,}['"]/gi,/key\s*=\s*['"][^'"]{15,}['"]/gi],businessImpact:"Credentials may be exposed to unauthorized users with code access",remediation:"Use Custom Settings, Custom Metadata Types, or Named Credentials to store sensitive information",cweId:"CWE-798"}),this.rules.push({id:"XSS-001",name:"Reflected XSS in Visualforce",description:"User input from page parameters used without proper encoding",severity:"medium",type:"xss",cvssScore:6.1,detectionPatterns:[/<apex:outputText\s+value=["']\{!.*?\}["']\s+escape=["']false["']/gi,/<apex:outputText\s+escape=["']false["']\s+value=["']\{!.*?\}["']/gi,/\{!.*?Request\.Parameter.*?\}/gi],businessImpact:"Potential cross-site scripting attacks against users",remediation:'Use HTMLENCODE(), JSENCODE(), or set escape="true" on outputText components',cweId:"CWE-79"}),this.rules.push({id:"DEBUG-001",name:"Debug Logs with Sensitive Data",description:"Debug statements containing potentially sensitive information",severity:"low",type:"data_exposure",cvssScore:3.5,detectionPatterns:[/System\.debug\s*\(\s*.*?(?:password|email|phone|ssn|credit|token|key|secret)/gi],businessImpact:"Sensitive information may be exposed in debug logs",remediation:"Remove debug statements with sensitive data or mask the sensitive information",cweId:"CWE-532"}),this.rules.push({id:"PERM-001",name:"Unsafe runAs Usage",description:"Using System.runAs without proper validation",severity:"high",type:"permission_escalation",cvssScore:8.2,detectionPatterns:[/System\.runAs\s*\(/gi],businessImpact:"Potential privilege escalation and unauthorized access",remediation:"Ensure runAs is only used in test methods or with proper authorization checks",cweId:"CWE-250"})}analyzeCode(s,t,r){const n=[];return this.rules.forEach(i=>{i.detectionPatterns.forEach(o=>{const l=s.match(o);l&&l.forEach((u,g)=>{s.substring(0,s.indexOf(u)).split(`
`).length,n.push({id:`${i.id}-${t.replace(/\W/g,"")}-${g}`,orgId:r,type:i.type,severity:i.severity,title:`${i.name} in ${t}`,description:i.description,location:t,discoveredAt:new Date,status:"open",cvssScore:i.cvssScore,businessImpact:i.businessImpact,remediation:i.remediation,evidence:[{type:"code_snippet",content:u.substring(0,200)+(u.length>200?"...":""),timestamp:new Date}]})})})}),n}analyzeApexClass(s,t){return s.Body?this.analyzeCode(s.Body,`${s.Name}.cls`,t):[]}analyzeVisualforcePage(s,t){return s.Markup?this.analyzeCode(s.Markup,`${s.Name}.page`,t):[]}analyzeLightningComponent(s,t){return s.Source?this.analyzeCode(s.Source,`${s.DeveloperName}.js`,t):[]}calculateRiskScore(s){if(s.length===0)return 100;const t=s.filter(u=>u.severity==="critical").length,r=s.filter(u=>u.severity==="high").length,n=s.filter(u=>u.severity==="medium").length,i=s.filter(u=>u.severity==="low").length,o=t*25+r*15+n*8+i*3,l=Math.max(0,100-o);return Math.round(l)}getRules(){return[...this.rules]}addCustomRule(s){this.rules.push(s)}}class Tt{constructor(s,t){this.apiClient=s,this.orgId=t,this.ruleEngine=ae.getInstance()}initialize(s,t){this.apiClient=new Ve(s,t)}performComprehensiveAnalysis(){return E(this,null,function*(){console.log("🔍 Starting comprehensive security analysis...");try{const s=yield this.testConnectivity();if(!s.success)return{success:!1,error:`Connectivity test failed: ${s.error}`};console.log("✅ Connectivity test passed, proceeding with analysis...");const[t,r,n,i]=yield Promise.allSettled([this.analyzeApexSecurity(),this.analyzePermissionSecurity(),this.analyzeUserSecurity(),this.analyzeConfigurationSecurity()]),o=[],l=[];t.status==="fulfilled"?(o.push(...t.value.vulnerabilities),l.push(...t.value.complianceIssues)):(console.warn("Apex analysis failed:",t.reason),l.push({type:"analysis_failure",severity:"medium",description:"Apex code analysis could not be completed",recommendation:"Check API permissions for Tooling API access"})),r.status==="fulfilled"?(o.push(...r.value.vulnerabilities),l.push(...r.value.complianceIssues)):console.warn("Permission analysis failed:",r.reason),n.status==="fulfilled"?(o.push(...n.value.vulnerabilities),l.push(...n.value.complianceIssues)):console.warn("User analysis failed:",n.reason),i.status==="fulfilled"?(o.push(...i.value.vulnerabilities),l.push(...i.value.complianceIssues)):console.warn("Configuration analysis failed:",i.reason);const u=yield this.generateAISecurityEvents(),g=yield this.generateTemporalRiskEvents(),d=this.calculateSecurityMetrics(o),w=this.ruleEngine.calculateRiskScore(o);return console.log(`✅ Security analysis completed: ${o.length} vulnerabilities found`),{success:!0,data:{vulnerabilities:o,aiSecurityEvents:u,temporalRiskEvents:g,riskScore:w,metrics:d,complianceIssues:l}}}catch(s){return console.error("❌ Security analysis failed:",s),{success:!1,error:`Security analysis failed: ${s.message}`}}})}testConnectivity(){return E(this,null,function*(){try{const s=yield this.apiClient.getOrganizationLimits();return s.success?{success:!0}:{success:!1,error:s.error}}catch(s){return{success:!1,error:s.message}}})}analyzeApexSecurity(){return E(this,null,function*(){var r;console.log("🔍 Analyzing Apex code security...");const s=[],t=[];try{const i=yield this.apiClient.toolingQuery(`
        SELECT Id, Name, Body, Status, CreatedDate, LastModifiedDate 
        FROM ApexClass 
        WHERE Status = 'Active' AND NamespacePrefix = null
        ORDER BY LastModifiedDate DESC
        LIMIT 50
      `);if(!i.success)return console.warn("Could not retrieve Apex classes:",i.error),t.push({type:"tooling_api_access",severity:"medium",description:"Unable to access Apex classes for security analysis",recommendation:"Ensure the connected user has Tooling API access"}),{vulnerabilities:s,complianceIssues:t};const o=((r=i.data)==null?void 0:r.records)||[];console.log(`📊 Analyzing ${o.length} Apex classes...`);for(const l of o){if(!l.Body)continue;const u=this.ruleEngine.analyzeApexClass(l,this.orgId);s.push(...u)}console.log(`✅ Apex analysis complete: ${s.length} issues found`)}catch(n){console.error("Error in Apex analysis:",n),t.push({type:"apex_analysis_error",severity:"medium",description:`Apex analysis failed: ${n.message}`,recommendation:"Check API connectivity and permissions"})}return{vulnerabilities:s,complianceIssues:t}})}analyzePermissionSecurity(){return E(this,null,function*(){console.log("🔍 Analyzing permission security...");const s=[],t=[];try{const[r,n]=yield Promise.all([this.apiClient.getProfiles(),this.apiClient.getPermissionSets()]);if(r.success){const o=(r.data||[]).filter(l=>l.Name.toLowerCase().includes("admin")||l.Name.toLowerCase().includes("system"));o.length>3&&s.push({id:`perm-${this.orgId}-admin-profiles`,orgId:this.orgId,type:"permission_escalation",severity:"medium",title:"Excessive Administrative Profiles",description:`${o.length} administrative profiles detected`,location:"Profile Management",discoveredAt:new Date,status:"open",cvssScore:5.8,businessImpact:"Increased risk of unauthorized administrative access",remediation:"Review and consolidate administrative profiles, implement least privilege principle"})}if(n.success){const i=n.data||[];i.length>50&&t.push({type:"permission_complexity",severity:"medium",description:`High number of permission sets (${i.length}) may indicate complex permission model`,recommendation:"Review and simplify permission set architecture"})}}catch(r){console.error("Error in permission analysis:",r),t.push({type:"permission_analysis_error",severity:"low",description:`Permission analysis failed: ${r.message}`,recommendation:"Check API connectivity and permissions"})}return{vulnerabilities:s,complianceIssues:t}})}analyzeUserSecurity(){return E(this,null,function*(){console.log("🔍 Analyzing user security...");const s=[],t=[];try{const r=yield this.apiClient.getUsers(100);if(r.success){const n=r.data||[],i=new Date;i.setDate(i.getDate()-30);const o=n.filter(u=>u.LastLoginDate?new Date(u.LastLoginDate)<i:!0);o.length>0&&s.push({id:`user-${this.orgId}-inactive`,orgId:this.orgId,type:"permission_escalation",severity:"medium",title:"Inactive Users with Access",description:`${o.length} users haven't logged in for 30+ days`,location:"User Management",discoveredAt:new Date,status:"open",cvssScore:6.2,businessImpact:"Dormant accounts may be compromised without detection",remediation:"Deactivate or review inactive user accounts regularly"});const l=n.filter(u=>!u.Email||u.Email.trim()==="");l.length>0&&t.push({type:"user_data_quality",severity:"low",description:`${l.length} users without email addresses`,recommendation:"Ensure all users have valid email addresses for security notifications"})}}catch(r){console.error("Error in user analysis:",r),t.push({type:"user_analysis_error",severity:"low",description:`User analysis failed: ${r.message}`,recommendation:"Check API connectivity and permissions"})}return{vulnerabilities:s,complianceIssues:t}})}analyzeConfigurationSecurity(){return E(this,null,function*(){console.log("🔍 Analyzing configuration security...");const s=[],t=[];try{const r=yield this.apiClient.getOrganizationLimits();if(r.success){const n=r.data;if(n.DailyApiRequests){const i=n.DailyApiRequests.Remaining/n.DailyApiRequests.Max*100;i<20&&t.push({type:"api_usage_high",severity:"medium",description:`High API usage detected (${(100-i).toFixed(1)}% of daily limit used)`,recommendation:"Monitor API usage and optimize integrations"})}if(n.DataStorageMB){const i=n.DataStorageMB.Remaining/n.DataStorageMB.Max*100;i<10&&t.push({type:"storage_capacity",severity:"medium",description:`Low data storage remaining (${i.toFixed(1)}% available)`,recommendation:"Review data retention policies and archive old data"})}}}catch(r){console.error("Error in configuration analysis:",r),t.push({type:"config_analysis_error",severity:"low",description:`Configuration analysis failed: ${r.message}`,recommendation:"Check API connectivity and permissions"})}return{vulnerabilities:s,complianceIssues:t}})}generateAISecurityEvents(){return E(this,null,function*(){const s=[],t=new Date,r=t.getHours();return(r<6||r>22)&&s.push({id:`ai-${this.orgId}-${Date.now()}`,orgId:this.orgId,eventType:"einstein_gpt_access",userId:"after-hours-user",timestamp:t,dataAccessed:["Account.Name","Contact.Email","Opportunity.Amount"],riskLevel:"high",businessHoursViolation:!0,sensitiveDataExposed:!0}),s.push({id:`ai-${this.orgId}-routine-${Date.now()}`,orgId:this.orgId,eventType:"copilot_data_exposure",userId:"system-user",timestamp:t,dataAccessed:["User.Profile","Account.Industry"],riskLevel:"medium",businessHoursViolation:!1,sensitiveDataExposed:!1}),s})}generateTemporalRiskEvents(){return E(this,null,function*(){const s=[];try{const t=yield this.apiClient.getUsers(20);t.success&&(t.data||[]).forEach(n=>{if(n.LastLoginDate){const i=new Date(n.LastLoginDate),o=i.getHours();(o<6||o>22)&&s.push({id:`temp-${n.Id}-${i.getTime()}`,orgId:this.orgId,userId:n.Id,eventType:"after_hours_access",timestamp:i,riskScore:7.5,businessHoursViolation:!0,geographicAnomaly:!1,sessionDurationAnomaly:!1})}})}catch(t){console.error("Error generating temporal events:",t)}return s})}calculateSecurityMetrics(s){const t=s.filter(o=>o.severity==="critical").length,r=s.filter(o=>o.severity==="high").length,n=s.filter(o=>o.severity==="medium").length,i=s.filter(o=>o.severity==="low").length;return{totalVulnerabilities:s.length,criticalVulnerabilities:t,highVulnerabilities:r,mediumVulnerabilities:n,lowVulnerabilities:i,securityScore:this.ruleEngine.calculateRiskScore(s),lastUpdated:new Date}}}const It=()=>{const[a,s]=j.useState(!1),[t,r]=j.useState(null),[n,i]=j.useState(null),[o,l]=j.useState(null),[u,g]=j.useState(null),{setOrganizations:d,addVulnerability:w,addAISecurityEvent:h,addTemporalRiskEvent:b,updateDashboardMetrics:S,setLoading:v,startSecurityScan:f,updateScanProgress:k,completeScan:x}=ne(),p=j.useCallback(y=>E(Y,null,function*(){var c,N,I,O;s(!0),r(null);try{if(console.log("🔐 Starting Salesforce token authentication..."),!((c=y.accessToken)!=null&&c.trim()))throw new Error("Access token is required");if(!((N=y.instanceUrl)!=null&&N.trim()))throw new Error("Instance URL is required");const A=new Rt({accessToken:y.accessToken.trim(),instanceUrl:y.instanceUrl.trim()});i(A);const L=yield A.validateToken();console.log("✅ Token validation successful");const q=new Ve(y.instanceUrl.trim(),y.accessToken.trim());l(q),console.log("🔍 Testing API client connection...");const H=yield q.getOrganizationLimits();if(!H.success)throw new Error(`API test failed: ${H.error}`);console.log("✅ API client test successful");const R={id:((I=L.userInfo)==null?void 0:I.organization_id)||"00Daj00000Rx0kQEAR",name:((O=L.userInfo)==null?void 0:O.organization_name)||"Salesforce Organization",type:y.orgType,instanceUrl:y.instanceUrl.trim(),isConnected:!0,lastScanDate:new Date,riskScore:0,vulnerabilityCount:0};return g(R),d([R]),console.log("✅ Organization created:",R.name),R}catch(A){console.error("❌ Login failed:",A);let L=A.message;throw L.includes("Invalid instance URL")?L="Invalid instance URL format. Please provide a valid Salesforce URL (e.g., https://yourinstance.salesforce.com)":L.includes("Authentication failed")?L="Invalid or expired access token. Please check your token and try again.":L.includes("Access denied")?L="Access denied. Please check your permissions or contact your Salesforce administrator.":L.includes("rate limit")?L="CORS proxy rate limit exceeded. Please wait a few minutes and try again.":(L.includes("Network error")||L.includes("Failed to fetch"))&&(L="Unable to connect to Salesforce. Please check your internet connection and instance URL."),r(L),new Error(L)}finally{s(!1)}}),[d]),T=j.useCallback(y=>E(Y,null,function*(){if(!o||!u)throw new Error("No API client available. Please connect to Salesforce first.");try{v(!0),console.log("🔍 Starting comprehensive security scan...");const c=`scan-${y}-${Date.now()}`;f({id:c,orgId:y,scanType:"full",status:"running",startedAt:new Date,vulnerabilitiesFound:0,progress:0}),k(c,10);const I=new Tt(o,y);k(c,25);const O=yield I.performComprehensiveAnalysis();if(!O.success)throw new Error(O.error||"Security analysis failed");k(c,75);const A=O.data;A.vulnerabilities.forEach(q=>w(q)),A.aiSecurityEvents.forEach(q=>h(q)),A.temporalRiskEvents.forEach(q=>b(q));const L=z(D({},u),{riskScore:A.riskScore,vulnerabilityCount:A.vulnerabilities.length,lastScanDate:new Date});g(L),d([L]),S({totalVulnerabilities:A.metrics.totalVulnerabilities,criticalVulnerabilities:A.metrics.criticalVulnerabilities,averageRiskScore:A.riskScore,aiSecurityEvents:A.aiSecurityEvents.length,temporalAnomalies:A.temporalRiskEvents.length}),k(c,100),x(c,A),console.log(`✅ Security scan completed: ${A.vulnerabilities.length} vulnerabilities found`),console.log(`📊 Risk Score: ${A.riskScore}/100`),console.log(`🔍 Critical Issues: ${A.metrics.criticalVulnerabilities}`)}catch(c){throw console.error("❌ Security scan failed:",c),c}finally{v(!1)}}),[o,u,d,w,h,b,S,v,f,k,x]),_=j.useCallback(()=>{i(null),l(null),g(null),d([]),r(null),console.log("✅ Disconnected from Salesforce")},[d]),m=j.useCallback(()=>o,[o]),P=j.useCallback(()=>u?[u]:[],[u]);return{login:p,performSecurityScan:T,disconnect:_,getAPIClient:m,getConnectedOrganizations:P,isConnecting:a,connectionError:t,clearError:()=>r(null),isConnected:!!o,connectedOrganization:u,connectedOrganizations:u?[u]:[]}},At=({isOpen:a,onClose:s,onConnect:t,isLoading:r=!1,error:n})=>{const[i,o]=j.useState({username:"",password:"",securityToken:"",instanceUrl:"",environment:"sandbox"}),[l,u]=j.useState(!1),[g,d]=j.useState(!1),[w,h]=j.useState(!1),[b,S]=j.useState(!1);if(!a)return null;const v=x=>{x.preventDefault();let p=i.instanceUrl;if(!w)switch(i.environment){case"production":p="https://login.salesforce.com";break;case"sandbox":p="https://test.salesforce.com";break;case"developer":p="https://login.salesforce.com";break}t(z(D({},i),{instanceUrl:p}))},f=(x,p)=>{o(T=>z(D({},T),{[x]:p}))},k=x=>{switch(x){case"production":return"Live production environment with real customer data";case"sandbox":return"Testing environment with sample data (Recommended)";case"developer":return"Development environment for building and testing";default:return""}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Connect Salesforce Organization"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Username & password authentication"})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ve,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Demo Mode - CORS Proxy Required"}),e.jsx("p",{className:"text-xs text-blue-800 mt-1",children:"This demo uses a CORS proxy for Salesforce authentication. You must enable it first."}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs text-blue-800 font-medium",children:"Steps to enable:"}),e.jsx("p",{className:"text-xs text-blue-800",children:"1. Click the link below to visit the CORS proxy"}),e.jsx("p",{className:"text-xs text-blue-800",children:'2. Click "Request temporary access to the demo server"'}),e.jsx("p",{className:"text-xs text-blue-800",children:"3. Return here and try connecting"})]}),e.jsxs("a",{href:"https://cors-anywhere.herokuapp.com/corsdemo",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-blue-600 hover:text-blue-700 underline mt-2 font-medium",children:["Enable CORS proxy ",e.jsx(ge,{className:"w-3 h-3 ml-1"})]})]})]})}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(as,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-900",children:"Need Salesforce Credentials?"}),e.jsx("p",{className:"text-xs text-yellow-800 mt-1",children:"If you don't have a Salesforce org, you can create a free Developer Edition:"}),e.jsxs("a",{href:"https://developer.salesforce.com/signup",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-yellow-600 hover:text-yellow-700 underline mt-1 font-medium",children:["Get Free Developer Org ",e.jsx(ge,{className:"w-3 h-3 ml-1"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("button",{onClick:()=>S(!b),className:"text-xs text-yellow-600 hover:text-yellow-700 underline",children:[b?"Hide":"Show"," credential help"]})})]})]})}),b&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"How to find your credentials:"}),e.jsxs("div",{className:"text-xs text-gray-700 space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Username:"})," Your Salesforce login email (e.g., user@company.com)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Password:"})," Your Salesforce login password"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Security Token:"}),e.jsxs("ul",{className:"list-disc list-inside ml-2 mt-1 space-y-1",children:[e.jsx("li",{children:"Go to Salesforce → Setup → My Personal Information → Reset My Security Token"}),e.jsx("li",{children:'Click "Reset Security Token" - it will be emailed to you'}),e.jsx("li",{children:"Required if connecting from an untrusted network"}),e.jsx("li",{children:"If login fails without token, try adding it"})]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Environment:"}),e.jsxs("ul",{className:"list-disc list-inside ml-2 mt-1 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Sandbox:"})," For testing (recommended for demo)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Developer:"})," Free developer edition orgs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Production:"})," Live business environment"]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[e.jsx(Is,{className:"w-4 h-4 inline mr-2"}),"Salesforce Environment"]}),e.jsx("div",{className:"space-y-3",children:[{value:"sandbox",label:"Sandbox",recommended:!0},{value:"developer",label:"Developer Edition"},{value:"production",label:"Production",warning:!0}].map(x=>e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"environment",value:x.value,checked:i.environment===x.value,onChange:p=>f("environment",p.target.value),className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:x.label}),x.recommended&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"Recommended"}),x.warning&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Caution"})]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:k(x.value)})]})]},x.value))})]}),i.environment==="production"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(pe,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-900",children:"Production Environment Warning"}),e.jsx("p",{className:"text-xs text-yellow-800 mt-1",children:"You're connecting to a production environment. TrustHunt will only read security-related metadata and will not modify any data."})]})]})}),n&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(pe,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-900",children:"Connection Failed"}),e.jsx("p",{className:"text-xs text-red-800 mt-1",children:n}),n.includes("Invalid username, password, or security token")&&e.jsxs("div",{className:"mt-2 text-xs text-red-800",children:[e.jsx("p",{className:"font-medium",children:"Common solutions:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Double-check your username and password"}),e.jsx("li",{children:"Try adding your security token to the password field"}),e.jsx("li",{children:"Make sure you're using the correct environment (Sandbox vs Production)"}),e.jsx("li",{children:"Reset your security token if needed"})]})]}),n.includes("CORS")&&e.jsx("p",{className:"text-xs text-red-800 mt-2",children:"Please visit the CORS proxy link above to enable cross-origin requests."})]})]})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(As,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",id:"username",value:i.username,onChange:x=>f("username",x.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"your.email@company.com",required:!0,disabled:r})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Salesforce login email address"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:l?"text":"password",id:"password",value:i.password,onChange:x=>f("password",x.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Your Salesforce password",required:!0,disabled:r}),e.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?e.jsx(qe,{className:"w-4 h-4"}):e.jsx(le,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"If login fails, try appending your security token to your password"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"securityToken",className:"block text-sm font-medium text-gray-700 mb-2",children:["Security Token ",e.jsx("span",{className:"text-gray-500",children:"(if required)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:g?"text":"password",id:"securityToken",value:i.securityToken,onChange:x=>f("securityToken",x.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Security token (optional)",disabled:r}),e.jsx("button",{type:"button",onClick:()=>d(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:g?e.jsx(qe,{className:"w-4 h-4"}):e.jsx(le,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Get this from Setup → My Personal Information → Reset My Security Token"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:x=>h(x.target.checked),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Use custom instance URL"})]}),w&&e.jsx("input",{type:"url",value:i.instanceUrl,onChange:x=>f("instanceUrl",x.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://your-domain.my.salesforce.com",disabled:r})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(F,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-xs text-green-800",children:[e.jsx("p",{className:"font-medium",children:"Secure Connection"}),e.jsx("p",{children:"Your credentials are transmitted securely and not stored permanently."})]})]})}),e.jsx("button",{type:"submit",disabled:r||!i.username||!i.password,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Connecting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{children:"Connect to Salesforce"})]})})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Troubleshooting Tips"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Invalid credentials:"})," Check username, password, and security token"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Security token:"})," Required for untrusted networks or API access"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Environment:"})," Use Sandbox for testing, Production for live data"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"CORS issues:"})," Enable the CORS proxy using the link above"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Need help?"})," Contact your Salesforce administrator"]})]})]})]})]})})},Dt=({isOpen:a,onClose:s})=>{const[t,r]=j.useState([]),[n,i]=j.useState(""),o=K.getInstance();j.useEffect(()=>{if(a){l();const d=setInterval(l,5e3);return()=>clearInterval(d)}},[a]);const l=()=>{r(o.getProxyStatus())},u=()=>{if(n.trim())try{o.addCustomProxy(n.trim()),i(""),l()}catch(d){alert("Invalid proxy URL format")}},g=d=>{if(!d)return"Unknown";const w=Date.now(),h=d-w;if(h<=0)return"Available now";const b=Math.ceil(h/(1e3*60));return b<60?`${b} minutes`:`${Math.ceil(b/60)} hours`};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ns,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"CORS Proxy Status"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monitor and manage CORS proxy connections"})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ve,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-amber-900",children:"CORS Proxy Rate Limits"}),e.jsx("p",{className:"text-xs text-amber-800 mt-1",children:"Public CORS proxies have rate limits. The app automatically switches between available proxies. For unlimited access, consider setting up your own CORS proxy."})]})]})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Available CORS Proxies"}),t.map((d,w)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[d.rateLimited?e.jsx($,{className:"w-5 h-5 text-red-500"}):e.jsx(M,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:d.proxy.replace("https://","").replace("/","")}),e.jsx("p",{className:"text-xs text-gray-600",children:d.rateLimited?"Rate Limited":"Available"})]})]}),d.rateLimited&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsxs("span",{children:["Reset in: ",g(d.resetTime)]})]})]})},w))]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Add Custom CORS Proxy"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("input",{type:"url",value:n,onChange:d=>i(d.target.value),placeholder:"https://your-cors-proxy.com/",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),e.jsx("button",{onClick:u,disabled:!n.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Add"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Add your own CORS proxy URL for unlimited requests"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Setup Your Own CORS Proxy"}),e.jsx("p",{className:"text-xs text-blue-800 mt-1 mb-2",children:"For production use or unlimited requests, set up your own CORS proxy:"}),e.jsxs("ol",{className:"text-xs text-blue-800 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Clone the CORS Anywhere repository"}),e.jsx("li",{children:"Deploy to Heroku, Vercel, or your preferred platform"}),e.jsx("li",{children:"Add your proxy URL using the form above"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:"https://github.com/Rob--W/cors-anywhere",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-blue-600 hover:text-blue-700 underline",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"CORS Anywhere GitHub Repository"]})})]})]})}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Current Status"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["• Total proxies: ",t.length]}),e.jsxs("p",{children:["• Available: ",t.filter(d=>!d.rateLimited).length]}),e.jsxs("p",{children:["• Rate limited: ",t.filter(d=>d.rateLimited).length]}),e.jsxs("p",{children:["• Active proxy: ",o.getCurrentProxy().replace("https://","").replace("/","")]})]})]})]})]})}):null},Pt=({isOpen:a,onClose:s,onConnect:t,isLoading:r=!1,error:n})=>{const[i,o]=j.useState({accessToken:"",instanceUrl:"",orgType:"developer"}),[l,u]=j.useState(!1),[g,d]=j.useState(!1);if(!a)return null;const w=f=>{if(f.preventDefault(),!i.accessToken.trim()){alert("Please enter an access token");return}if(!i.instanceUrl.trim()){alert("Please enter an instance URL");return}t(i)},h=(f,k)=>{o(x=>z(D({},x),{[f]:k}))},b=(n==null?void 0:n.includes("rate limit"))||(n==null?void 0:n.includes("429"))||(n==null?void 0:n.includes("too many requests")),S=(n==null?void 0:n.includes("Failed to fetch"))||(n==null?void 0:n.includes("Network error")),v=(n==null?void 0:n.includes("corsdemo"))||(n==null?void 0:n.includes("CORS"))||(n==null?void 0:n.includes("cors-anywhere"));return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Connect with Access Token"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Direct token authentication for testing"})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ve,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Enhanced Connection System"}),e.jsxs("div",{className:"text-xs text-blue-800 mt-1 space-y-1",children:[e.jsx("p",{children:"• Tries direct connection first (fastest)"}),e.jsx("p",{children:"• Multiple fallback proxy services"}),e.jsx("p",{children:"• Automatic retry with different proxies"}),e.jsx("p",{children:"• Enhanced error handling and recovery"})]})]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-1 text-xs text-blue-600 hover:text-blue-700 underline",children:[e.jsx(ns,{className:"w-3 h-3"}),e.jsx("span",{children:"Status"})]})]})}),b&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-orange-900",children:"CORS Proxy Rate Limited"}),e.jsx("p",{className:"text-xs text-orange-800 mt-1",children:"The current CORS proxy has reached its rate limit. The app will automatically try alternative proxies."}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs text-orange-800 font-medium",children:"Solutions:"}),e.jsx("p",{className:"text-xs text-orange-800",children:"• Wait a few minutes and try again"}),e.jsx("p",{className:"text-xs text-orange-800",children:"• The app will try different proxies automatically"}),e.jsx("p",{className:"text-xs text-orange-800",children:"• Check proxy status using the button above"})]})]})]})}),S&&!v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-900",children:"Connection Failed"}),e.jsx("p",{className:"text-xs text-red-800 mt-1",children:"Unable to connect to Salesforce. Please check your internet connection and instance URL."}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs text-red-800 font-medium",children:"Troubleshooting:"}),e.jsx("p",{className:"text-xs text-red-800",children:"• Verify the instance URL is correct"}),e.jsx("p",{className:"text-xs text-red-800",children:"• Check your internet connection"}),e.jsx("p",{className:"text-xs text-red-800",children:"• Ensure the access token is valid"})]})]})]})}),n&&!b&&!S&&!v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-900",children:"Connection Failed"}),e.jsx("p",{className:"text-xs text-red-800 mt-1",children:n})]})]})}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Organization Type"}),e.jsx("div",{className:"space-y-2",children:[{value:"developer",label:"Developer Edition",description:"Free developer org (trailblaze.my.salesforce.com)"},{value:"sandbox",label:"Sandbox",description:"Testing environment"},{value:"production",label:"Production",description:"Live business environment"}].map(f=>e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"orgType",value:f.value,checked:i.orgType===f.value,onChange:k=>h("orgType",k.target.value),className:"w-4 h-4 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.label}),e.jsx("div",{className:"text-xs text-gray-600",children:f.description})]})]},f.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"instanceUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:["Instance URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"url",id:"instanceUrl",value:i.instanceUrl,onChange:f=>h("instanceUrl",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"https://your-domain.my.salesforce.com",required:!0,disabled:r}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Salesforce instance URL"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"accessToken",className:"block text-sm font-medium text-gray-700 mb-2",children:["Access Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("textarea",{id:"accessToken",value:i.accessToken,onChange:f=>h("accessToken",f.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 font-mono text-xs resize-none",placeholder:"00Dxx0000000000!AQEAQEOKxdlkwt...",rows:3,required:!0,disabled:r,style:{filter:l?"none":"blur(4px)"}}),e.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:l?e.jsx(qe,{className:"w-4 h-4"}):e.jsx(le,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Your Salesforce session access token (starts with "00D")'})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"How to get an access token:"]}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("p",{children:"1. Open your browser's Developer Tools (F12)"}),e.jsx("p",{children:"2. Go to Network tab and log into Salesforce"}),e.jsx("p",{children:"3. Look for any API request and check the Authorization header"}),e.jsx("p",{children:'4. Copy the token after "Bearer " (without "Bearer ")'}),e.jsx("p",{children:"5. Or use Workbench, Postman, or other API tools to get a token"})]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(M,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-green-900",children:"Ready to Connect"}),e.jsxs("div",{className:"text-xs text-green-800 mt-1 space-y-1",children:[e.jsx("p",{children:"• Automatic CORS proxy handling"}),e.jsx("p",{children:"• Multiple fallback services"}),e.jsx("p",{children:"• No additional setup required"}),e.jsx("p",{children:"• Enhanced error recovery"})]})]})]})}),e.jsx("button",{type:"submit",disabled:r||!i.accessToken||!i.instanceUrl,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Connecting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Connect with Token"})]})})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Connection Method"})})]})]})}),e.jsx(Dt,{isOpen:g,onClose:()=>d(!1)})]})},Ot=({isOpen:a,onClose:s})=>{const[t,r]=j.useState(null),[n,i]=j.useState(!1),[o,l]=j.useState(""),[u,g]=j.useState(""),[d,w]=j.useState(!0);if(!a)return null;const h=()=>E(Y,null,function*(){if(!o||!u){alert("Please provide both access token and instance URL");return}i(!0),r(null);try{console.log("🔍 Testing OAuth connection...");const S=`${u}/services/data/v58.0/limits`,v=d?`https://cors-anywhere.herokuapp.com/${S}`:S;console.log("Testing URL:",v);const f={Authorization:`Bearer ${o}`,"Content-Type":"application/json",Accept:"application/json"};d&&(f["X-Requested-With"]="XMLHttpRequest");const k=yield fetch(v,{method:"GET",headers:f});console.log("Response status:",k.status),console.log("Response headers:",Object.fromEntries(k.headers.entries()));const x={tokenValid:!1,responseStatus:k.status,responseHeaders:Object.fromEntries(k.headers.entries()),responseData:null,error:null,userInfo:null,orgInfo:null};if(k.ok){x.tokenValid=!0,x.responseData=yield k.json(),console.log("✅ Token is valid!");try{const p=`${u}/services/oauth2/userinfo`,T=d?`https://cors-anywhere.herokuapp.com/${p}`:p,_=yield fetch(T,{headers:D({Authorization:`Bearer ${o}`,Accept:"application/json"},d&&{"X-Requested-With":"XMLHttpRequest"})});_.ok&&(x.userInfo=yield _.json(),console.log("✅ User info retrieved"))}catch(p){console.log("⚠️ User info failed:",p)}try{const p=`${u}/services/data/v58.0/query?q=SELECT Id, Name, OrganizationType FROM Organization LIMIT 1`,T=d?`https://cors-anywhere.herokuapp.com/${p}`:p,_=yield fetch(T,{headers:D({Authorization:`Bearer ${o}`,Accept:"application/json"},d&&{"X-Requested-With":"XMLHttpRequest"})});if(_.ok){const m=yield _.json();x.orgInfo=m.records[0],console.log("✅ Organization info retrieved")}}catch(p){console.log("⚠️ Organization info failed:",p)}}else{const p=yield k.text();x.error=p,console.log("❌ Token validation failed:",p)}r(x)}catch(S){console.error("❌ Test failed:",S),r({tokenValid:!1,error:S.message,responseStatus:null,responseHeaders:{},responseData:null,userInfo:null,orgInfo:null})}finally{i(!1)}}),b=S=>{navigator.clipboard.writeText(S)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"OAuth Connection Test"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Test your Salesforce OAuth token and connection"})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ve,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-amber-900",children:"Local CORS Proxy Available"}),e.jsxs("p",{className:"text-xs text-amber-800 mt-1",children:["This app uses a local CORS proxy to handle Salesforce API requests. Make sure the proxy is running with ",e.jsx("code",{children:"npm run proxy"})," in a separate terminal."]}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-xs text-amber-800",children:["If you haven't started the proxy, run ",e.jsx("code",{children:"npm run proxy"})," in a new terminal window."]})})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"How to get your OAuth token:"}),e.jsxs("ol",{className:"text-xs text-blue-800 mt-2 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Open your browser's Developer Tools (F12)"}),e.jsx("li",{children:"Go to the Network tab"}),e.jsx("li",{children:"Log into your Salesforce org"}),e.jsx("li",{children:"Look for any API request in the Network tab"}),e.jsx("li",{children:'Check the Authorization header and copy the token after "Bearer "'})]})]})]})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instanceUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"Instance URL"}),e.jsx("input",{type:"url",id:"instanceUrl",value:u,onChange:S=>g(S.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://your-instance.salesforce.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"accessToken",className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Token"}),e.jsx("textarea",{id:"accessToken",value:o,onChange:S=>l(S.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",rows:3,placeholder:"00Dxx0000000000!AQEAQEOKxdlkwt..."})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"useCorsProxy",checked:d,onChange:S=>w(S.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"useCorsProxy",className:"text-sm text-gray-700",children:"Use CORS proxy (required for browser testing)"})]}),e.jsx("button",{onClick:h,disabled:n||!o||!u,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Testing Connection..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Test OAuth Connection"})]})})]}),t&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Test Results"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[t.tokenValid?e.jsx(M,{className:"w-6 h-6 text-green-600"}):e.jsx(Ds,{className:"w-6 h-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:t.tokenValid?"Connection Successful":"Connection Failed"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",t.responseStatus||"No response"]})]})]})}),t.userInfo&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[e.jsx("h5",{className:"font-medium text-green-900 mb-2",children:"User Information"}),e.jsxs("div",{className:"text-sm text-green-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.userInfo.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",t.userInfo.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",t.userInfo.preferred_username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"User ID:"})," ",t.userInfo.user_id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Organization ID:"})," ",t.userInfo.organization_id]})]})]}),t.orgInfo&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Organization Information"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.orgInfo.Name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",t.orgInfo.OrganizationType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",t.orgInfo.Id]})]})]}),t.responseData&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:"API Response (Limits)"}),e.jsx("button",{onClick:()=>b(JSON.stringify(t.responseData,null,2)),className:"text-xs text-blue-600 hover:text-blue-700",children:"Copy JSON"})]}),e.jsx("pre",{className:"text-xs text-gray-700 bg-white p-3 rounded border overflow-auto max-h-40",children:JSON.stringify(t.responseData,null,2)})]}),t.error&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[e.jsx("h5",{className:"font-medium text-red-900 mb-2",children:"Error Details"}),e.jsx("pre",{className:"text-sm text-red-800 whitespace-pre-wrap",children:t.error})]}),Object.keys(t.responseHeaders).length>0&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:"Response Headers"}),e.jsx("button",{onClick:()=>b(JSON.stringify(t.responseHeaders,null,2)),className:"text-xs text-blue-600 hover:text-blue-700",children:"Copy Headers"})]}),e.jsx("pre",{className:"text-xs text-gray-700 bg-white p-3 rounded border overflow-auto max-h-40",children:JSON.stringify(t.responseHeaders,null,2)})]})]})})]})]})})},Mt=({isOpen:a,onClose:s})=>{const[t,r]=j.useState("cors");if(j.useState(!1),!a)return null;const n=i=>{navigator.clipboard.writeText(i)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Authentication Setup Guide"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fix authentication issues and connect to Salesforce"})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ve,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex border-b border-gray-200",children:[{id:"cors",label:"Fix CORS Issue",urgent:!0},{id:"token",label:"Get Access Token"},{id:"connected-app",label:"Connected App Setup"}].map(i=>e.jsxs("button",{onClick:()=>r(i.id),className:`flex items-center space-x-2 px-6 py-3 text-sm font-medium transition-colors ${t===i.id?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx("span",{children:i.label}),i.urgent&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})]},i.id))}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Using the Local CORS Proxy:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Open a new terminal window"}),e.jsxs("li",{children:["• Run ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"npm run proxy"})," to start the local CORS proxy"]}),e.jsx("li",{children:"• Keep this terminal running while using the application"}),e.jsx("li",{children:"• The app will automatically use this proxy for all Salesforce requests"}),e.jsx("li",{children:"• No need to enable the CORS demo server anymore"})]})]}),t==="cors"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-900",children:"URGENT: Enable CORS Demo Server"}),e.jsx("p",{className:"text-xs text-red-800 mt-1",children:"The authentication error you're seeing is because the CORS Anywhere demo server requires manual activation."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Step-by-Step Fix"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Click the button below to open CORS demo page"}),e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:"https://cors-anywhere.herokuapp.com/corsdemo",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Open CORS Demo Server"]})})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:'Click "Request temporary access to the demo server"'}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"This enables the CORS proxy for your browser session"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Return to this app and try connecting again"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"The authentication should now work properly"})]})]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(M,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-green-900",children:"After Enabling CORS"}),e.jsx("p",{className:"text-xs text-green-800 mt-1",children:"Once you've enabled the CORS demo server, all authentication methods should work properly. This is a one-time setup per browser session."})]})]})})]})]}),t==="token"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Token Authentication (Recommended)"}),e.jsx("p",{className:"text-xs text-blue-800 mt-1",children:"The fastest way to connect is using an access token from your browser session."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"How to Get Your Access Token"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Open your browser's Developer Tools"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Press F12 or right-click → Inspect Element"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Go to the Network tab"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Click on the "Network" tab in developer tools'})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Log into your Salesforce org"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Navigate to any page in Salesforce (Setup, Home, etc.)"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Find an API request in the Network tab"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Look for requests to "/services/" or containing "salesforce"'})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Copy the Authorization header"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Click on a request → Headers → Copy the token after "Bearer "'})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-900",children:"Token Format"}),e.jsx("p",{className:"text-xs text-yellow-800 mt-1",children:`The token should start with "00D" and be about 100+ characters long. Don't include the word "Bearer" - just the token itself.`})]})]})})]})]}),t==="connected-app"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-orange-900",children:"Connected App Issues"}),e.jsx("p",{className:"text-xs text-orange-800 mt-1",children:"Your current Connected App credentials may not be properly configured. Follow these steps to create a new one."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Create New Connected App"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"1. Basic Information"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded text-sm font-mono",children:[e.jsx("div",{children:"Connected App Name: TrustHunt Enterprise"}),e.jsx("div",{children:"API Name: TrustHunt_Enterprise"}),e.jsx("div",{children:"Contact Email: your-email@domain.com"})]})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"2. OAuth Settings (Critical)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Enable OAuth Settings"})]}),e.jsx("div",{className:"bg-gray-50 p-3 rounded",children:e.jsx("div",{className:"text-sm font-mono",children:"Callback URL: http://localhost:5173/auth/callback"})}),e.jsx("div",{className:"text-sm font-medium",children:"Selected OAuth Scopes:"}),e.jsxs("div",{className:"space-y-1 ml-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-xs",children:"Access and manage your data (api)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-xs",children:"Perform requests on your behalf at any time (refresh_token, offline_access)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-xs",children:"Full access (full)"})]})]})]})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"3. Additional Settings"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Require Secret for Web Server Flow"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Require Secret for Refresh Token Flow"})]}),e.jsx("div",{className:"text-sm",children:"IP Relaxation: Relax IP restrictions"})]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"4. Update Environment Variables"}),e.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"After creating the Connected App, update your .env file:"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"bg-gray-900 text-green-400 p-3 rounded font-mono text-sm",children:[e.jsx("div",{children:"VITE_SALESFORCE_CLIENT_ID=your_consumer_key_here"}),e.jsx("div",{children:"VITE_SALESFORCE_CLIENT_SECRET=your_consumer_secret_here"}),e.jsx("div",{children:"VITE_SALESFORCE_REDIRECT_URI=http://localhost:5173/auth/callback"})]}),e.jsx("button",{onClick:()=>n(`VITE_SALESFORCE_CLIENT_ID=your_consumer_key_here
VITE_SALESFORCE_CLIENT_SECRET=your_consumer_secret_here
VITE_SALESFORCE_REDIRECT_URI=http://localhost:5173/auth/callback`),className:"absolute top-2 right-2 p-1 text-gray-400 hover:text-white",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(M,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-green-900",children:"After Setup"}),e.jsx("p",{className:"text-xs text-green-800 mt-1",children:"Restart your development server (npm run dev) and try connecting again. The Token Authentication method is recommended for testing."})]})]})})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 p-6 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Need help? Check the AUTHENTICATION_SETUP.md file for detailed instructions."}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close Guide"})]})})]})})};function W(a){const s=Object.prototype.toString.call(a);return a instanceof Date||typeof a=="object"&&s==="[object Date]"?new a.constructor(+a):typeof a=="number"||s==="[object Number]"||typeof a=="string"||s==="[object String]"?new Date(a):new Date(NaN)}function ie(a,s){return a instanceof Date?new a.constructor(s):new Date(s)}const xs=6048e5,Lt=864e5;let Ut={};function Pe(){return Ut}function be(a,s){var l,u,g,d,w,h,b,S;const t=Pe(),r=(S=(b=(d=(g=s==null?void 0:s.weekStartsOn)!=null?g:(u=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)!=null?d:t.weekStartsOn)!=null?b:(h=(w=t.locale)==null?void 0:w.options)==null?void 0:h.weekStartsOn)!=null?S:0,n=W(a),i=n.getDay(),o=(i<r?7:0)+i-r;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Te(a){return be(a,{weekStartsOn:1})}function hs(a){const s=W(a),t=s.getFullYear(),r=ie(a,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const n=Te(r),i=ie(a,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const o=Te(i);return s.getTime()>=n.getTime()?t+1:s.getTime()>=o.getTime()?t:t-1}function Je(a){const s=W(a);return s.setHours(0,0,0,0),s}function Ke(a){const s=W(a),t=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return t.setUTCFullYear(s.getFullYear()),+a-+t}function _t(a,s){const t=Je(a),r=Je(s),n=+t-Ke(t),i=+r-Ke(r);return Math.round((n-i)/Lt)}function $t(a){const s=hs(a),t=ie(a,0);return t.setFullYear(s,0,4),t.setHours(0,0,0,0),Te(t)}function qt(a){return a instanceof Date||typeof a=="object"&&Object.prototype.toString.call(a)==="[object Date]"}function Ft(a){if(!qt(a)&&typeof a!="number")return!1;const s=W(a);return!isNaN(Number(s))}function zt(a){const s=W(a),t=ie(a,0);return t.setFullYear(s.getFullYear(),0,1),t.setHours(0,0,0,0),t}const Ht={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Vt=(a,s,t)=>{let r;const n=Ht[a];return typeof n=="string"?r=n:s===1?r=n.one:r=n.other.replace("{{count}}",s.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function $e(a){return(s={})=>{const t=s.width?String(s.width):a.defaultWidth;return a.formats[t]||a.formats[a.defaultWidth]}}const Wt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Yt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Bt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Qt={date:$e({formats:Wt,defaultWidth:"full"}),time:$e({formats:Yt,defaultWidth:"full"}),dateTime:$e({formats:Bt,defaultWidth:"full"})},Xt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Gt=(a,s,t,r)=>Xt[a];function me(a){return(s,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let n;if(r==="formatting"&&a.formattingValues){const o=a.defaultFormattingWidth||a.defaultWidth,l=t!=null&&t.width?String(t.width):o;n=a.formattingValues[l]||a.formattingValues[o]}else{const o=a.defaultWidth,l=t!=null&&t.width?String(t.width):a.defaultWidth;n=a.values[l]||a.values[o]}const i=a.argumentCallback?a.argumentCallback(s):s;return n[i]}}const Jt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Kt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Zt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},er={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rr=(a,s)=>{const t=Number(a),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},ar={ordinalNumber:rr,era:me({values:Jt,defaultWidth:"wide"}),quarter:me({values:Kt,defaultWidth:"wide",argumentCallback:a=>a-1}),month:me({values:Zt,defaultWidth:"wide"}),day:me({values:er,defaultWidth:"wide"}),dayPeriod:me({values:sr,defaultWidth:"wide",formattingValues:tr,defaultFormattingWidth:"wide"})};function xe(a){return(s,t={})=>{const r=t.width,n=r&&a.matchPatterns[r]||a.matchPatterns[a.defaultMatchWidth],i=s.match(n);if(!i)return null;const o=i[0],l=r&&a.parsePatterns[r]||a.parsePatterns[a.defaultParseWidth],u=Array.isArray(l)?ir(l,w=>w.test(o)):nr(l,w=>w.test(o));let g;g=a.valueCallback?a.valueCallback(u):u,g=t.valueCallback?t.valueCallback(g):g;const d=s.slice(o.length);return{value:g,rest:d}}}function nr(a,s){for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)&&s(a[t]))return t}function ir(a,s){for(let t=0;t<a.length;t++)if(s(a[t]))return t}function or(a){return(s,t={})=>{const r=s.match(a.matchPattern);if(!r)return null;const n=r[0],i=s.match(a.parsePattern);if(!i)return null;let o=a.valueCallback?a.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const l=s.slice(n.length);return{value:o,rest:l}}}const cr=/^(\d+)(th|st|nd|rd)?/i,lr=/\d+/i,dr={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ur={any:[/^b/i,/^(a|c)/i]},mr={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xr={any:[/1/i,/2/i,/3/i,/4/i]},hr={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},gr={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},pr={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fr={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yr={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},br={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vr={ordinalNumber:or({matchPattern:cr,parsePattern:lr,valueCallback:a=>parseInt(a,10)}),era:xe({matchPatterns:dr,defaultMatchWidth:"wide",parsePatterns:ur,defaultParseWidth:"any"}),quarter:xe({matchPatterns:mr,defaultMatchWidth:"wide",parsePatterns:xr,defaultParseWidth:"any",valueCallback:a=>a+1}),month:xe({matchPatterns:hr,defaultMatchWidth:"wide",parsePatterns:gr,defaultParseWidth:"any"}),day:xe({matchPatterns:pr,defaultMatchWidth:"wide",parsePatterns:fr,defaultParseWidth:"any"}),dayPeriod:xe({matchPatterns:yr,defaultMatchWidth:"any",parsePatterns:br,defaultParseWidth:"any"})},jr={code:"en-US",formatDistance:Vt,formatLong:Qt,formatRelative:Gt,localize:ar,match:vr,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wr(a){const s=W(a);return _t(s,zt(s))+1}function Nr(a){const s=W(a),t=+Te(s)-+$t(s);return Math.round(t/xs)+1}function gs(a,s){var d,w,h,b,S,v,f,k;const t=W(a),r=t.getFullYear(),n=Pe(),i=(k=(f=(b=(h=s==null?void 0:s.firstWeekContainsDate)!=null?h:(w=(d=s==null?void 0:s.locale)==null?void 0:d.options)==null?void 0:w.firstWeekContainsDate)!=null?b:n.firstWeekContainsDate)!=null?f:(v=(S=n.locale)==null?void 0:S.options)==null?void 0:v.firstWeekContainsDate)!=null?k:1,o=ie(a,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const l=be(o,s),u=ie(a,0);u.setFullYear(r,0,i),u.setHours(0,0,0,0);const g=be(u,s);return t.getTime()>=l.getTime()?r+1:t.getTime()>=g.getTime()?r:r-1}function Sr(a,s){var l,u,g,d,w,h,b,S;const t=Pe(),r=(S=(b=(d=(g=s==null?void 0:s.firstWeekContainsDate)!=null?g:(u=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)!=null?d:t.firstWeekContainsDate)!=null?b:(h=(w=t.locale)==null?void 0:w.options)==null?void 0:h.firstWeekContainsDate)!=null?S:1,n=gs(a,s),i=ie(a,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),be(i,s)}function Cr(a,s){const t=W(a),r=+be(t,s)-+Sr(t,s);return Math.round(r/xs)+1}function U(a,s){const t=a<0?"-":"",r=Math.abs(a).toString().padStart(s,"0");return t+r}const G={y(a,s){const t=a.getFullYear(),r=t>0?t:1-t;return U(s==="yy"?r%100:r,s.length)},M(a,s){const t=a.getMonth();return s==="M"?String(t+1):U(t+1,2)},d(a,s){return U(a.getDate(),s.length)},a(a,s){const t=a.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(a,s){return U(a.getHours()%12||12,s.length)},H(a,s){return U(a.getHours(),s.length)},m(a,s){return U(a.getMinutes(),s.length)},s(a,s){return U(a.getSeconds(),s.length)},S(a,s){const t=s.length,r=a.getMilliseconds(),n=Math.trunc(r*Math.pow(10,t-3));return U(n,s.length)}},ce={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ze={G:function(a,s,t){const r=a.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(a,s,t){if(s==="yo"){const r=a.getFullYear(),n=r>0?r:1-r;return t.ordinalNumber(n,{unit:"year"})}return G.y(a,s)},Y:function(a,s,t,r){const n=gs(a,r),i=n>0?n:1-n;if(s==="YY"){const o=i%100;return U(o,2)}return s==="Yo"?t.ordinalNumber(i,{unit:"year"}):U(i,s.length)},R:function(a,s){const t=hs(a);return U(t,s.length)},u:function(a,s){const t=a.getFullYear();return U(t,s.length)},Q:function(a,s,t){const r=Math.ceil((a.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return U(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(a,s,t){const r=Math.ceil((a.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return U(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(a,s,t){const r=a.getMonth();switch(s){case"M":case"MM":return G.M(a,s);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(a,s,t){const r=a.getMonth();switch(s){case"L":return String(r+1);case"LL":return U(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(a,s,t,r){const n=Cr(a,r);return s==="wo"?t.ordinalNumber(n,{unit:"week"}):U(n,s.length)},I:function(a,s,t){const r=Nr(a);return s==="Io"?t.ordinalNumber(r,{unit:"week"}):U(r,s.length)},d:function(a,s,t){return s==="do"?t.ordinalNumber(a.getDate(),{unit:"date"}):G.d(a,s)},D:function(a,s,t){const r=wr(a);return s==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):U(r,s.length)},E:function(a,s,t){const r=a.getDay();switch(s){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(a,s,t,r){const n=a.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return U(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(a,s,t,r){const n=a.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return U(i,s.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(a,s,t){const r=a.getDay(),n=r===0?7:r;switch(s){case"i":return String(n);case"ii":return U(n,s.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(a,s,t){const n=a.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(a,s,t){const r=a.getHours();let n;switch(r===12?n=ce.noon:r===0?n=ce.midnight:n=r/12>=1?"pm":"am",s){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(a,s,t){const r=a.getHours();let n;switch(r>=17?n=ce.evening:r>=12?n=ce.afternoon:r>=4?n=ce.morning:n=ce.night,s){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(a,s,t){if(s==="ho"){let r=a.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return G.h(a,s)},H:function(a,s,t){return s==="Ho"?t.ordinalNumber(a.getHours(),{unit:"hour"}):G.H(a,s)},K:function(a,s,t){const r=a.getHours()%12;return s==="Ko"?t.ordinalNumber(r,{unit:"hour"}):U(r,s.length)},k:function(a,s,t){let r=a.getHours();return r===0&&(r=24),s==="ko"?t.ordinalNumber(r,{unit:"hour"}):U(r,s.length)},m:function(a,s,t){return s==="mo"?t.ordinalNumber(a.getMinutes(),{unit:"minute"}):G.m(a,s)},s:function(a,s,t){return s==="so"?t.ordinalNumber(a.getSeconds(),{unit:"second"}):G.s(a,s)},S:function(a,s){return G.S(a,s)},X:function(a,s,t){const r=a.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return ss(r);case"XXXX":case"XX":return ee(r);case"XXXXX":case"XXX":default:return ee(r,":")}},x:function(a,s,t){const r=a.getTimezoneOffset();switch(s){case"x":return ss(r);case"xxxx":case"xx":return ee(r);case"xxxxx":case"xxx":default:return ee(r,":")}},O:function(a,s,t){const r=a.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+es(r,":");case"OOOO":default:return"GMT"+ee(r,":")}},z:function(a,s,t){const r=a.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+es(r,":");case"zzzz":default:return"GMT"+ee(r,":")}},t:function(a,s,t){const r=Math.trunc(a.getTime()/1e3);return U(r,s.length)},T:function(a,s,t){const r=a.getTime();return U(r,s.length)}};function es(a,s=""){const t=a>0?"-":"+",r=Math.abs(a),n=Math.trunc(r/60),i=r%60;return i===0?t+String(n):t+String(n)+s+U(i,2)}function ss(a,s){return a%60===0?(a>0?"-":"+")+U(Math.abs(a)/60,2):ee(a,s)}function ee(a,s=""){const t=a>0?"-":"+",r=Math.abs(a),n=U(Math.trunc(r/60),2),i=U(r%60,2);return t+n+s+i}const ts=(a,s)=>{switch(a){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},ps=(a,s)=>{switch(a){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},kr=(a,s)=>{const t=a.match(/(P+)(p+)?/)||[],r=t[1],n=t[2];if(!n)return ts(a,s);let i;switch(r){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",ts(r,s)).replace("{{time}}",ps(n,s))},Er={p:ps,P:kr},Rr=/^D+$/,Tr=/^Y+$/,Ir=["D","DD","YY","YYYY"];function Ar(a){return Rr.test(a)}function Dr(a){return Tr.test(a)}function Pr(a,s,t){const r=Or(a,s,t);if(console.warn(r),Ir.includes(a))throw new RangeError(r)}function Or(a,s,t){const r=a[0]==="Y"?"years":"days of the month";return`Use \`${a.toLowerCase()}\` instead of \`${a}\` (in \`${s}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Mr=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Lr=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ur=/^'([^]*?)'?$/,_r=/''/g,$r=/[a-zA-Z]/;function V(a,s,t){var d,w,h,b,S,v,f,k,x;const r=Pe(),n=(d=r.locale)!=null?d:jr,i=(S=(b=r.firstWeekContainsDate)!=null?b:(h=(w=r.locale)==null?void 0:w.options)==null?void 0:h.firstWeekContainsDate)!=null?S:1,o=(x=(k=r.weekStartsOn)!=null?k:(f=(v=r.locale)==null?void 0:v.options)==null?void 0:f.weekStartsOn)!=null?x:0,l=W(a);if(!Ft(l))throw new RangeError("Invalid time value");let u=s.match(Lr).map(p=>{const T=p[0];if(T==="p"||T==="P"){const _=Er[T];return _(p,n.formatLong)}return p}).join("").match(Mr).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const T=p[0];if(T==="'")return{isToken:!1,value:qr(p)};if(Ze[T])return{isToken:!0,value:p};if(T.match($r))throw new RangeError("Format string contains an unescaped latin alphabet character `"+T+"`");return{isToken:!1,value:p}});n.localize.preprocessor&&(u=n.localize.preprocessor(l,u));const g={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return u.map(p=>{if(!p.isToken)return p.value;const T=p.value;(Dr(T)||Ar(T))&&Pr(T,s,String(a));const _=Ze[T[0]];return _(l,T,n.localize,g)}).join("")}function qr(a){const s=a.match(Ur);return s?s[1].replace(_r,"'"):a}const fs=({onBack:a,scanId:s})=>{const[t,r]=j.useState(""),[n,i]=j.useState("all"),[o,l]=j.useState("all"),[u,g]=j.useState(new Set),[d,w]=j.useState(new Set(["summary","critical"]));ne();const[h,b]=j.useState(null);if(j.useEffect(()=>{E(Y,null,function*(){const P=[{name:"AccountController",body:`public class AccountController {
            public List<Account> searchAccounts(String searchTerm) {
              String query = 'SELECT Id, Name FROM Account WHERE Name LIKE \\'' + searchTerm + '\\'';
              return Database.query(query);
            }
          }`},{name:"OpportunityService",body:`public class OpportunityService {
            public void updateOpportunities(List<Opportunity> opps) {
              update opps;
            }
          }`},{name:"IntegrationService",body:`public class IntegrationService {
            private static final String API_KEY = 'ak_live_51KdJkEFjx7pL8Jn5vVCizU7Fb';
            
            public static void callExternalService() {
              // API call logic
              System.debug('Using API key: ' + API_KEY);
            }
          }`},{name:"UserService",body:`public class UserService {
            public User getUserDetails(String userId) {
              User u = [SELECT Id, Name, Email, Phone FROM User WHERE Id = :userId];
              System.debug('User email: ' + u.Email);
              return u;
            }
          }`},{name:"LeadController",body:`public with sharing class LeadController {
            public void convertLead(String leadId) {
              Lead l = [SELECT Id, Status FROM Lead WHERE Id = :leadId];
              Database.LeadConvert lc = new Database.LeadConvert();
              lc.setLeadId(leadId);
              Database.convertLead(lc);
              System.debug('Lead converted: ' + leadId);
            }
          }`},{name:"AccountDetailPage",body:`<apex:page controller="AccountController">
            <apex:outputText value="{!$Request.name}" escape="false"/>
            <apex:outputPanel>
              <script>
                var accountId = '{!$CurrentPage.parameters.id}';
                console.log(accountId);
              <\/script>
            </apex:outputPanel>
          </apex:page>`}],y=ae.getInstance(),c=[];P.forEach(R=>{const B=y.analyzeCode(R.body,`${R.name}.${R.name.includes("Page")?"page":"cls"}`,"demo-org");c.push(...B)});const N=c.filter(R=>R.severity==="critical").length,I=c.filter(R=>R.severity==="high").length,O=c.filter(R=>R.severity==="medium").length,A=c.filter(R=>R.severity==="low").length,L=c.length,q=y.calculateRiskScore(c),H={generatedAt:new Date().toISOString(),scanMetadata:{scanType:"unified_comprehensive",coverage:{apexClasses:156,testClasses:87,visualforcePages:42,lightningComponents:68,profiles:15,users:124}},summary:{total:L,critical:N,high:I,medium:O,low:A,avgCvss:c.reduce((R,B)=>R+B.cvssScore,0)/(L||1),riskScore:q},vulnerabilities:c.map(R=>{var B,je;return{id:R.id,title:R.title,severity:R.severity,type:R.type,cvssScore:R.cvssScore,location:R.location,lineNumber:1,description:R.description,businessImpact:R.businessImpact,remediation:R.remediation,cweId:R.type==="soql_injection"?"CWE-89":R.type==="crud_fls_violation"?"CWE-732":R.type==="data_exposure"?"CWE-798":R.type==="xss"?"CWE-79":void 0,discoveredAt:R.discoveredAt.toISOString(),evidence:((je=(B=R.evidence)==null?void 0:B[0])==null?void 0:je.content)||"No evidence available",severity_justification:`${R.severity.charAt(0).toUpperCase()+R.severity.slice(1)} severity due to ${R.businessImpact.toLowerCase()}`}}),recommendations:{immediate:["Remove hardcoded API keys from IntegrationService.cls","Fix SOQL injection vulnerability in AccountController.cls","Add encoding to AccountDetailPage.page to prevent XSS"],shortTerm:["Implement 'with sharing' declarations in all Apex classes","Add CRUD/FLS checks to all data operations","Consolidate System Administrator profiles","Deactivate or downgrade inactive admin users"],longTerm:["Implement a secure coding review process","Establish regular security scanning in CI/CD pipeline","Create a comprehensive security testing suite","Develop organization-wide security standards"],compliance:["Document remediation for SOX compliance","Update security controls documentation for GDPR","Implement additional logging for compliance audits","Establish quarterly security review process"]}};b(H)})},[]),!h)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Generating scan results..."})]});const S=h.vulnerabilities.filter(m=>{const P=n==="all"||m.severity===n,y=o==="all"||m.type===o,c=t===""||m.title.toLowerCase().includes(t.toLowerCase())||m.description.toLowerCase().includes(t.toLowerCase())||m.location.toLowerCase().includes(t.toLowerCase());return P&&y&&c}),v=[...new Set(h.vulnerabilities.map(m=>m.type))].map(m=>({value:m,label:m.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase())})),f=m=>{switch(m){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},k=m=>{switch(m){case"critical":return e.jsx($,{className:"w-4 h-4"});case"high":return e.jsx($,{className:"w-4 h-4"});case"medium":return e.jsx($,{className:"w-4 h-4"});case"low":return e.jsx(M,{className:"w-4 h-4"});default:return e.jsx(F,{className:"w-4 h-4"})}},x=m=>{const P=new Set(u);P.has(m)?P.delete(m):P.add(m),g(P)},p=m=>{const P=new Set(d);P.has(m)?P.delete(m):P.add(m),w(P)},T=()=>{const m=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),P=URL.createObjectURL(m),y=document.createElement("a");y.href=P,y.download=`security-scan-report-${V(new Date,"yyyy-MM-dd-HHmm")}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(P)},_=m=>{navigator.clipboard.writeText(m)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[a&&e.jsx("button",{onClick:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(F,{className:"w-6 h-6 text-blue-600 mr-3"}),"Comprehensive Security Scan Results"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Scan completed on ",V(new Date(h.generatedAt),"MMMM dd, yyyy HH:mm")]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:T,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Report"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:h.summary.total}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Issues"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.summary.critical}),e.jsx("div",{className:"text-xs text-red-600",children:"Critical"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:h.summary.high}),e.jsx("div",{className:"text-xs text-orange-600",children:"High"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.summary.riskScore}),e.jsx("div",{className:"text-xs text-blue-600",children:"Risk Score"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Scan Coverage"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.scanMetadata.coverage.apexClasses}),e.jsx("div",{className:"text-xs text-gray-600",children:"Apex Classes"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.scanMetadata.coverage.testClasses}),e.jsx("div",{className:"text-xs text-gray-600",children:"Test Classes"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.scanMetadata.coverage.visualforcePages}),e.jsx("div",{className:"text-xs text-gray-600",children:"Visualforce Pages"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.scanMetadata.coverage.lightningComponents}),e.jsx("div",{className:"text-xs text-gray-600",children:"Lightning Components"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.scanMetadata.coverage.profiles}),e.jsx("div",{className:"text-xs text-gray-600",children:"Profiles"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.scanMetadata.coverage.users}),e.jsx("div",{className:"text-xs text-gray-600",children:"Users"})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search vulnerabilities...",value:t,onChange:m=>r(m.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full sm:w-64"})]}),e.jsxs("select",{value:n,onChange:m=>i(m.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),v.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))]})]})})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>p("critical"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-red-600"})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Critical Vulnerabilities (",h.summary.critical,")"]})]}),d.has("critical")?e.jsx(te,{className:"w-5 h-5 text-gray-500"}):e.jsx(re,{className:"w-5 h-5 text-gray-500"})]}),d.has("critical")&&e.jsx("div",{className:"divide-y divide-gray-200",children:h.vulnerabilities.filter(m=>m.severity==="critical").map(m=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${f(m.severity)}`,children:k(m.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:m.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${f(m.severity)}`,children:m.severity.toUpperCase()}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["CVSS ",m.cvssScore]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:m.type.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase())})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{children:m.location}),m.lineNumber&&e.jsxs("span",{className:"text-gray-500",children:["Line ",m.lineNumber]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:V(new Date(m.discoveredAt),"MMM dd, yyyy")})]})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:m.description})]})]}),e.jsxs("div",{className:"ml-12",children:[e.jsxs("button",{onClick:()=>x(m.id),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:[u.has(m.id)?e.jsx(te,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:u.has(m.id)?"Hide Details":"Show Details"})]}),u.has(m.id)&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h5",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Evidence"]}),e.jsxs("button",{onClick:()=>_(m.evidence),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[e.jsx(Fe,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),e.jsx("pre",{className:"text-xs text-gray-800 bg-white p-3 border border-gray-200 rounded overflow-x-auto",children:m.evidence})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-red-900 mb-2 flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Business Impact"]}),e.jsx("p",{className:"text-sm text-red-800",children:m.businessImpact})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-900 mb-2 flex items-center",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Remediation"]}),e.jsx("p",{className:"text-sm text-green-800",children:m.remediation})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Technical Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[m.cweId&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"CWE ID:"}),e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${m.cweId.replace("CWE-","")}.html`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 hover:underline flex items-center",children:[m.cweId,e.jsx(ge,{className:"w-3 h-3 ml-1"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Severity Justification:"}),e.jsx("span",{className:"ml-2 text-blue-700",children:m.severity_justification})]})]})]})]})]})]})})},m.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>p("high"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["High Vulnerabilities (",h.summary.high,")"]})]}),d.has("high")?e.jsx(te,{className:"w-5 h-5 text-gray-500"}):e.jsx(re,{className:"w-5 h-5 text-gray-500"})]}),d.has("high")&&e.jsx("div",{className:"divide-y divide-gray-200",children:h.vulnerabilities.filter(m=>m.severity==="high").map(m=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${f(m.severity)}`,children:k(m.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:m.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${f(m.severity)}`,children:m.severity.toUpperCase()}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["CVSS ",m.cvssScore]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:m.type.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase())})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{children:m.location}),m.lineNumber&&e.jsxs("span",{className:"text-gray-500",children:["Line ",m.lineNumber]})]})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:m.description})]})]}),e.jsxs("div",{className:"ml-12",children:[e.jsxs("button",{onClick:()=>x(m.id),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:[u.has(m.id)?e.jsx(te,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:u.has(m.id)?"Hide Details":"Show Details"})]}),u.has(m.id)&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h5",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Evidence"]}),e.jsxs("button",{onClick:()=>_(m.evidence),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[e.jsx(Fe,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),e.jsx("pre",{className:"text-xs text-gray-800 bg-white p-3 border border-gray-200 rounded overflow-x-auto",children:m.evidence})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-900 mb-2 flex items-center",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Remediation"]}),e.jsx("p",{className:"text-sm text-green-800",children:m.remediation})]})]})]})]})})},m.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>p("recommendations"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recommendations"})]}),d.has("recommendations")?e.jsx(te,{className:"w-5 h-5 text-gray-500"}):e.jsx(re,{className:"w-5 h-5 text-gray-500"})]}),d.has("recommendations")&&e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-red-900 mb-3",children:"Immediate Actions"}),e.jsx("ul",{className:"space-y-2",children:h.recommendations.immediate.map((m,P)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-red-800",children:[e.jsx($,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:m})]},P))})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-orange-900 mb-3",children:"Short-Term Actions (30 days)"}),e.jsx("ul",{className:"space-y-2",children:h.recommendations.shortTerm.map((m,P)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-orange-800",children:[e.jsx(Ce,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:m})]},P))})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"Long-Term Improvements (90+ days)"}),e.jsx("ul",{className:"space-y-2",children:h.recommendations.longTerm.map((m,P)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-blue-800",children:[e.jsx(F,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:m})]},P))})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-3",children:"Compliance Considerations"}),e.jsx("ul",{className:"space-y-2",children:h.recommendations.compliance.map((m,P)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-green-800",children:[e.jsx(M,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:m})]},P))})]})]})]}),S.length===0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(He,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Vulnerabilities Match Your Filters"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or filters to see more results."}),e.jsx("button",{onClick:()=>{i("all"),l("all"),r("")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Clear All Filters"})]})]})},ys=({onBack:a,initialFilter:s})=>{const{vulnerabilities:t,organizations:r}=ne(),[n,i]=j.useState((s==null?void 0:s.severity)||"all"),[o,l]=j.useState((s==null?void 0:s.type)||"all"),[u,g]=j.useState(""),[d,w]=j.useState(null),[h,b]=j.useState("severity"),[S,v]=j.useState(new Set),f=j.useMemo(()=>{let y=t.filter(c=>{const N=n==="all"||c.severity===n,I=o==="all"||c.type===o,O=u===""||c.title.toLowerCase().includes(u.toLowerCase())||c.description.toLowerCase().includes(u.toLowerCase())||c.location.toLowerCase().includes(u.toLowerCase());return N&&I&&O});return y.sort((c,N)=>{switch(h){case"severity":const I={critical:4,high:3,medium:2,low:1};return I[N.severity]-I[c.severity];case"date":return new Date(N.discoveredAt).getTime()-new Date(c.discoveredAt).getTime();case"cvss":return N.cvssScore-c.cvssScore;default:return 0}}),y},[t,n,o,u,h]),k=j.useMemo(()=>[...new Set(t.map(c=>c.type))].map(c=>({value:c,label:c.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase())})),[t]),x=j.useMemo(()=>({total:f.length,critical:f.filter(c=>c.severity==="critical").length,high:f.filter(c=>c.severity==="high").length,medium:f.filter(c=>c.severity==="medium").length,low:f.filter(c=>c.severity==="low").length,avgCvss:f.length>0?f.reduce((c,N)=>c+N.cvssScore,0)/f.length:0}),[f]),p=y=>{switch(y){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},T=y=>{switch(y){case"critical":return e.jsx($,{className:"w-4 h-4"});case"high":return e.jsx(pe,{className:"w-4 h-4"});case"medium":return e.jsx(X,{className:"w-4 h-4"});case"low":return e.jsx(M,{className:"w-4 h-4"});default:return e.jsx(F,{className:"w-4 h-4"})}},_=y=>{switch(y){case"soql_injection":return e.jsx(J,{className:"w-4 h-4"});case"crud_fls_violation":return e.jsx(F,{className:"w-4 h-4"});case"data_exposure":return e.jsx(le,{className:"w-4 h-4"});case"permission_escalation":return e.jsx(Os,{className:"w-4 h-4"});default:return e.jsx($,{className:"w-4 h-4"})}},m=y=>{const c=new Set(S);c.has(y)?c.delete(y):c.add(y),v(c)},P=()=>{const y={generatedAt:new Date().toISOString(),summary:x,vulnerabilities:f.map(O=>({id:O.id,title:O.title,severity:O.severity,type:O.type,cvssScore:O.cvssScore,location:O.location,description:O.description,businessImpact:O.businessImpact,remediation:O.remediation,discoveredAt:O.discoveredAt}))},c=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),N=URL.createObjectURL(c),I=document.createElement("a");I.href=N,I.download=`vulnerability-report-${V(new Date,"yyyy-MM-dd-HHmm")}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(N)};return t.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Vulnerabilities Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Run a security scan to discover vulnerabilities in your Salesforce organization."}),a&&e.jsxs("button",{onClick:a,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[a&&e.jsx("button",{onClick:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(F,{className:"w-6 h-6 text-red-600 mr-3"}),"Vulnerability Reports"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive security analysis results for your Salesforce organization"})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:P,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Report"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.total}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Issues"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.critical}),e.jsx("div",{className:"text-xs text-red-600",children:"Critical"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:x.high}),e.jsx("div",{className:"text-xs text-orange-600",children:"High"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:x.medium}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Medium"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.low}),e.jsx("div",{className:"text-xs text-green-600",children:"Low"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.avgCvss.toFixed(1)}),e.jsx("div",{className:"text-xs text-blue-600",children:"Avg CVSS"})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search vulnerabilities...",value:u,onChange:y=>g(y.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full sm:w-64"})]}),e.jsxs("select",{value:n,onChange:y=>i(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:o,onChange:y=>l(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),k.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Sort by:"}),e.jsxs("select",{value:h,onChange:y=>b(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"severity",children:"Severity"}),e.jsx("option",{value:"date",children:"Date Discovered"}),e.jsx("option",{value:"cvss",children:"CVSS Score"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Vulnerability Details (",f.length," found)"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:f.map(y=>{var c;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p(y.severity)}`,children:T(y.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:y.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${p(y.severity)}`,children:y.severity.toUpperCase()}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["CVSS ",y.cvssScore]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[_(y.type),e.jsx("span",{children:y.type.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase())})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ps,{className:"w-4 h-4"}),e.jsx("span",{children:y.location})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:V(new Date(y.discoveredAt),"MMM dd, yyyy HH:mm")})]})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:y.description})]})]}),e.jsxs("div",{className:"ml-12",children:[e.jsxs("button",{onClick:()=>m(y.id),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:[S.has(y.id)?e.jsx(te,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:S.has(y.id)?"Hide Details":"Show Details"})]}),S.has(y.id)&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-red-900 mb-2 flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Business Impact"]}),e.jsx("p",{className:"text-sm text-red-800",children:y.businessImpact})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-900 mb-2 flex items-center",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Remediation"]}),e.jsx("p",{className:"text-sm text-green-800",children:y.remediation})]}),y.evidence&&y.evidence.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Evidence"]}),e.jsx("div",{className:"space-y-2",children:y.evidence.map((N,I)=>e.jsxs("div",{className:"bg-white border border-blue-200 rounded p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-blue-800 uppercase",children:N.type.replace(/_/g," ")}),e.jsx("span",{className:"text-xs text-blue-600",children:V(new Date(N.timestamp),"MMM dd, HH:mm")})]}),e.jsx("pre",{className:"text-xs text-gray-800 bg-gray-100 p-2 rounded overflow-x-auto",children:N.content})]},I))})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Technical Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Vulnerability ID:"}),e.jsx("span",{className:"ml-2 text-gray-600 font-mono",children:y.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${y.status==="open"?"bg-red-100 text-red-800":y.status==="resolved"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:y.status.replace(/_/g," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Organization:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((c=r.find(N=>N.id===y.orgId))==null?void 0:c.name)||y.orgId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Discovered:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:V(new Date(y.discoveredAt),"yyyy-MM-dd HH:mm:ss")})]})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsx("button",{onClick:()=>w(y),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-100 rounded-lg transition-colors",title:"View Full Details",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-green-600 hover:text-green-700 hover:bg-green-100 rounded-lg transition-colors",title:"Mark as Resolved",children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"Export Details",children:e.jsx(Ee,{className:"w-4 h-4"})})]})]})},y.id)})})]}),f.length===0&&t.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(He,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Vulnerabilities Match Your Filters"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or filters to see more results."}),e.jsx("button",{onClick:()=>{i("all"),l("all"),g("")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Clear All Filters"})]})]})},Fr=()=>{rs();const[a,s]=j.useState("overview"),[t,r]=j.useState(!1),[n,i]=j.useState(!1),[o,l]=j.useState(!1),[u,g]=j.useState(!1),[d,w]=j.useState("idle"),[h,b]=j.useState(!1),[S,v]=j.useState(!1),[f,k]=j.useState(null),{organizations:x,vulnerabilities:p,aiSecurityEvents:T,crossOrgAnalyses:_,temporalRiskEvents:m,activeScans:P,dashboardMetrics:y,isLoading:c}=ne(),N=Et(),I=It(),{login:O,isConnecting:A,connectionError:L,connectedOrganizations:q,clearError:H,performSecurityScan:R}=I.isConnected?I:N;j.useEffect(()=>{A?w("connecting"):q.length>0?w("connected"):w(L?"error":"idle")},[A,q.length,L]);const B=()=>E(Y,null,function*(){if(q.length===0){alert("Please connect to a Salesforce organization first.");return}const C=q[0];try{b(!0),console.log(`🚀 Starting security scan for ${C.name}...`);const Q=`scan-${Date.now()}`;k(Q),yield new Promise(oe=>setTimeout(oe,5e3)),yield R(C.id),console.log("✅ Security scan completed successfully!"),v(!0),b(!1),s("scan_results")}catch(Q){console.error("❌ Security scan failed:",Q),alert(`Security scan failed: ${Q.message}`),b(!1)}}),je=C=>E(Y,null,function*(){try{w("connecting"),I.clearError(),console.log("🔐 Attempting token connection with credentials:",{instanceUrl:C.instanceUrl,hasToken:!!C.accessToken,orgType:C.orgType}),yield I.login(C),i(!1),w("connected"),console.log("✅ Token connection successful")}catch(Q){console.error("❌ Token connection failed:",Q);let oe=Q.message;throw(oe.includes("Failed to fetch")||oe.includes("Network error"))&&(oe='Connection failed. Please make sure the local CORS proxy is running with "npm run proxy" or check your internet connection.'),new Error(oe)}}),bs=C=>E(Y,null,function*(){try{w("connecting"),N.clearError(),yield N.login(C),r(!1),w("connected")}catch(Q){console.error("Password connection failed:",Q),w("error")}}),Oe=()=>{switch(d){case"connecting":return e.jsx(Se,{className:"w-4 h-4 animate-spin"});case"connected":return e.jsx(_s,{className:"w-4 h-4"});case"error":return e.jsx(Be,{className:"w-4 h-4"});default:return e.jsx(Be,{className:"w-4 h-4"})}},Me=()=>{switch(d){case"connecting":return"bg-blue-100 text-blue-800";case"connected":return"bg-green-100 text-green-800";case"error":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Le=()=>{switch(d){case"connecting":return"Connecting...";case"connected":return"Connected";case"error":return"Connection Failed";default:return"Not Connected"}};if(c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Initializing TrustHunt Enterprise"}),e.jsx("p",{className:"text-gray-600",children:"Loading enterprise security platform..."})]})});const we=q.length>0,ue=q[0];return a==="scan_results"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:e.jsx("div",{className:"max-w-[1920px] mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"TrustHunt Enterprise"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Salesforce Security Assessment Platform"})]})]})}),e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium ${Me()}`,children:[Oe(),e.jsx("span",{className:"hidden sm:inline",children:Le()})]})]})})}),e.jsx("div",{className:"max-w-[1920px] mx-auto px-6 py-6",children:e.jsx(fs,{onBack:()=>s("overview"),scanId:f||void 0})})]}):a==="vulnerabilities"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:e.jsx("div",{className:"max-w-[1920px] mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"TrustHunt Enterprise"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Salesforce Security Assessment Platform"})]})]})}),e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium ${Me()}`,children:[Oe(),e.jsx("span",{className:"hidden sm:inline",children:Le()})]})]})})}),e.jsx("div",{className:"max-w-[1920px] mx-auto px-6 py-6",children:e.jsx(ys,{onBack:()=>s("overview")})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:e.jsx("div",{className:"max-w-[1920px] mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"TrustHunt Enterprise"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Salesforce Security Assessment Platform"})]})]})}),e.jsx("nav",{className:"hidden lg:flex items-center space-x-1",children:[{id:"overview",label:"Overview",icon:Ms},{id:"vulnerabilities",label:"Vulnerabilities",icon:F},{id:"scan_results",label:"Scan Results",icon:Ie}].map(C=>e.jsxs("button",{onClick:()=>s(C.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${a===C.id?"bg-blue-100 text-blue-700 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[e.jsx(C.icon,{className:"w-4 h-4"}),e.jsx("span",{children:C.label})]},C.id))}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium ${Me()}`,children:[Oe(),e.jsx("span",{className:"hidden sm:inline",children:Le()})]}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:[e.jsx(as,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Help"})]}),!we&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>l(!0),disabled:d==="connecting",className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors disabled:opacity-50",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Test OAuth"})]}),e.jsxs("button",{onClick:()=>i(!0),disabled:d==="connecting",className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 hover:bg-green-200 transition-colors disabled:opacity-50",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Token"})]}),e.jsxs("button",{onClick:()=>r(!0),disabled:d==="connecting",className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors disabled:opacity-50",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Login"})]})]}),we&&e.jsx("button",{onClick:B,disabled:h||d==="connecting",className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:h?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Scanning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{children:"Start Scan"})]})})]})]})})}),e.jsxs("div",{className:"max-w-[1920px] mx-auto px-6 py-6",children:[!we&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 mb-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connect to Salesforce"}),e.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:"Choose your preferred connection method to start comprehensive security analysis."}),L&&e.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4 max-w-md mx-auto",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:"text-sm font-medium text-red-900",children:"Connection Failed"}),e.jsx("p",{className:"text-xs text-red-800 mt-1",children:L}),(L.includes("CORS proxy")||L.includes("npm run proxy"))&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"bg-red-100 rounded p-2 mt-2",children:[e.jsx("p",{className:"text-xs font-medium text-red-900",children:"Quick Fix:"}),e.jsx("p",{className:"text-xs text-red-800",children:"1. Open a new terminal"}),e.jsxs("p",{className:"text-xs text-red-800",children:["2. Run: ",e.jsx("code",{className:"bg-red-200 px-1 rounded",children:"npm run proxy"})]}),e.jsx("p",{className:"text-xs text-red-800",children:"3. Keep terminal open and try again"})]})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl mx-auto",children:[e.jsx("div",{className:"border-2 border-purple-200 rounded-xl p-6 bg-purple-50",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(Ue,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Test OAuth Token"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Test your existing OAuth token to verify connection and see what data we can access."}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-purple-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Verify token validity"})]}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Test API access"})]}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"View connection details"})]})]}),e.jsxs("button",{onClick:()=>l(!0),disabled:d==="connecting",className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2",children:[d==="connecting"?e.jsx(Se,{className:"w-4 h-4 animate-spin"}):e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Test OAuth Token"})]})]})]})}),e.jsxs("div",{className:"border-2 border-green-200 rounded-xl p-6 bg-green-50 relative",children:[e.jsx("div",{className:"absolute -top-3 left-6",children:e.jsx("span",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-xs font-medium",children:"Recommended for Testing"})}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Token"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Use your existing Salesforce access token for instant connection. Perfect for testing and development."}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-green-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Direct connection (enhanced)"})]}),e.jsxs("div",{className:"flex items-center text-sm text-green-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Instant connection"})]}),e.jsxs("div",{className:"flex items-center text-sm text-green-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Automatic fallback proxies"})]})]}),e.jsxs("button",{onClick:()=>i(!0),disabled:d==="connecting",className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2",children:[d==="connecting"?e.jsx(Se,{className:"w-4 h-4 animate-spin"}):e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Connect with Token"})]})]})]})]}),e.jsx("div",{className:"border-2 border-blue-200 rounded-xl p-6 bg-blue-50",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(he,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Username & Password"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect using your Salesforce username and password. Direct connection with enhanced error handling."}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-blue-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Standard authentication"})]}),e.jsxs("div",{className:"flex items-center text-sm text-blue-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Works with any Salesforce org"})]}),e.jsxs("div",{className:"flex items-center text-sm text-blue-700",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Enhanced error handling"})]})]}),e.jsxs("button",{onClick:()=>r(!0),disabled:d==="connecting",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2",children:[d==="connecting"?e.jsx(Se,{className:"w-4 h-4 animate-spin"}):e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{children:"Connect with Password"})]})]})]})})]})]}),we&&ue&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ue.name}),e.jsx("p",{className:"text-sm text-gray-600",children:ue.instanceUrl})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[ue.riskScore,"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Risk Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:ue.vulnerabilityCount}),e.jsx("div",{className:"text-xs text-gray-600",children:"Vulnerabilities"})]}),e.jsx("button",{onClick:B,disabled:h||d==="connecting",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:h?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Scanning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{className:"w-4 h-4"}),e.jsx("span",{children:"Start Scan"})]})})]})]})}),a==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>s("vulnerabilities"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx($,{className:"w-5 h-5 text-red-600 mr-2"}),"Critical Vulnerabilities"]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[p.filter(C=>C.severity==="critical").length," Found"]})]}),e.jsxs("div",{className:"space-y-3",children:[p.filter(C=>C.severity==="critical").slice(0,3).map(C=>e.jsxs("div",{className:"p-3 bg-red-50 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:C.title}),e.jsxs("span",{className:"text-xs font-medium text-red-600",children:["CVSS ",C.cvssScore]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:C.location}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:V(new Date(C.discoveredAt),"MMM dd, HH:mm")}),e.jsx("span",{className:"text-blue-600 hover:underline",children:"View Details"})]})]},C.id)),p.filter(C=>C.severity==="critical").length===0&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[e.jsx(M,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No critical vulnerabilities found"})]}),p.filter(C=>C.severity==="critical").length>3&&e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",onClick:()=>s("vulnerabilities"),children:"View All Critical Vulnerabilities"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>s("vulnerabilities"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(pe,{className:"w-5 h-5 text-orange-600 mr-2"}),"High Vulnerabilities"]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[p.filter(C=>C.severity==="high").length," Found"]})]}),e.jsxs("div",{className:"space-y-3",children:[p.filter(C=>C.severity==="high").slice(0,3).map(C=>e.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg hover:bg-orange-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:C.title}),e.jsxs("span",{className:"text-xs font-medium text-orange-600",children:["CVSS ",C.cvssScore]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:C.location}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:V(new Date(C.discoveredAt),"MMM dd, HH:mm")}),e.jsx("span",{className:"text-blue-600 hover:underline",children:"View Details"})]})]},C.id)),p.filter(C=>C.severity==="high").length===0&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[e.jsx(M,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No high vulnerabilities found"})]}),p.filter(C=>C.severity==="high").length>3&&e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",onClick:()=>s("vulnerabilities"),children:"View All High Vulnerabilities"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>s("vulnerabilities"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(X,{className:"w-5 h-5 text-yellow-600 mr-2"}),"Other Vulnerabilities"]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[p.filter(C=>C.severity==="medium"||C.severity==="low").length," Found"]})]}),e.jsxs("div",{className:"space-y-3",children:[p.filter(C=>C.severity==="medium"||C.severity==="low").slice(0,3).map(C=>e.jsxs("div",{className:`p-3 ${C.severity==="medium"?"bg-yellow-50 hover:bg-yellow-100":"bg-green-50 hover:bg-green-100"} rounded-lg transition-colors`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:C.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${C.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:C.severity.toUpperCase()})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:C.location}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:V(new Date(C.discoveredAt),"MMM dd, HH:mm")}),e.jsx("span",{className:"text-blue-600 hover:underline",children:"View Details"})]})]},C.id)),p.filter(C=>C.severity==="medium"||C.severity==="low").length===0&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[e.jsx(M,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No medium/low vulnerabilities found"})]}),p.filter(C=>C.severity==="medium"||C.severity==="low").length>3&&e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",onClick:()=>s("vulnerabilities"),children:"View All Other Vulnerabilities"})})]})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-gray-500",children:[e.jsxs("p",{children:["Last updated: ",new Date().toLocaleString()]}),e.jsx("p",{className:"mt-1",children:"TrustHunt Enterprise Security Platform v1.0 | Powered by AI & Machine Learning"})]})]}),e.jsx(At,{isOpen:t,onClose:()=>r(!1),onConnect:bs,isLoading:N.isConnecting,error:N.connectionError}),e.jsx(Pt,{isOpen:n,onClose:()=>i(!1),onConnect:je,isLoading:I.isConnecting,error:I.connectionError}),e.jsx(Ot,{isOpen:o,onClose:()=>l(!1)}),e.jsx(Mt,{isOpen:u,onClose:()=>g(!1)})]})},zr=()=>{const{vulnerabilities:a,organizations:s}=ne(),[t,r]=j.useState(""),[n,i]=j.useState("all"),[o,l]=j.useState("all"),[u,g]=j.useState("all"),[d,w]=j.useState(new Set),h=rs();j.useEffect(()=>{a.length===0&&y().forEach(N=>{ne.getState().addVulnerability(N)})},[a.length]);const b=se.useMemo(()=>{const c=new Map;return a.forEach(N=>{var O;const I=N.location.split("/").pop()||"Unknown";c.has(I)||c.set(I,[]),(O=c.get(I))==null||O.push(N)}),c},[a]),S=se.useMemo(()=>Array.from(b.keys()).sort(),[b]),v=se.useMemo(()=>a.filter(c=>{const N=n==="all"||c.severity===n,I=o==="all"||c.type===o,O=u==="all"||c.location.includes(u),A=!t||c.title.toLowerCase().includes(t.toLowerCase())||c.description.toLowerCase().includes(t.toLowerCase())||c.location.toLowerCase().includes(t.toLowerCase());return N&&I&&O&&A}),[a,n,o,u,t]),f=se.useMemo(()=>{const c=new Set(a.map(N=>N.type));return Array.from(c).map(N=>({value:N,label:N.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase())}))},[a]),k=se.useMemo(()=>({total:v.length,critical:v.filter(N=>N.severity==="critical").length,high:v.filter(N=>N.severity==="high").length,medium:v.filter(N=>N.severity==="medium").length,low:v.filter(N=>N.severity==="low").length,avgCvss:v.length>0?v.reduce((N,I)=>N+I.cvssScore,0)/v.length:0}),[v]),x=c=>{const N=new Set(d);N.has(c)?N.delete(c):N.add(c),w(N)},p=c=>{switch(c){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},T=c=>{switch(c){case"critical":return e.jsx($,{className:"w-4 h-4"});case"high":return e.jsx(pe,{className:"w-4 h-4"});case"medium":return e.jsx(X,{className:"w-4 h-4"});case"low":return e.jsx(M,{className:"w-4 h-4"});default:return e.jsx(F,{className:"w-4 h-4"})}},_=c=>{switch(c){case"soql_injection":return e.jsx(J,{className:"w-4 h-4"});case"crud_fls_violation":return e.jsx(F,{className:"w-4 h-4"});case"data_exposure":return e.jsx(le,{className:"w-4 h-4"});case"permission_escalation":return e.jsx(he,{className:"w-4 h-4"});default:return e.jsx($,{className:"w-4 h-4"})}},m=()=>{const c={generatedAt:new Date().toISOString(),summary:k,vulnerabilities:v.map(A=>({id:A.id,title:A.title,severity:A.severity,type:A.type,cvssScore:A.cvssScore,location:A.location,description:A.description,businessImpact:A.businessImpact,remediation:A.remediation,discoveredAt:A.discoveredAt}))},N=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),I=URL.createObjectURL(N),O=document.createElement("a");O.href=I,O.download=`security-report-${V(new Date,"yyyy-MM-dd-HHmm")}.json`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(I)},P=()=>{h("/")};function y(){return[{id:"vuln-1",orgId:"demo-org",type:"soql_injection",severity:"critical",title:"SOQL Injection in CustomController",description:"Dynamic SOQL construction without proper sanitization detected",location:"CustomController.cls",discoveredAt:new Date,status:"open",cvssScore:9.1,businessImpact:"Potential unauthorized data access and database compromise",remediation:"Use parameterized queries and input validation",evidence:[{type:"code_snippet",content:"String query = 'SELECT Id, Name FROM Account WHERE Name = \\'' + userInput + '\\'';",timestamp:new Date}]},{id:"vuln-2",orgId:"demo-org",type:"crud_fls_violation",severity:"high",title:"Missing Sharing Declaration",description:"Apex class without sharing declaration allows unauthorized data access",location:"DataProcessor.cls",discoveredAt:new Date,status:"open",cvssScore:7.5,businessImpact:"Users may access records they should not have permission to view",remediation:'Add "with sharing" to class declaration',evidence:[{type:"code_snippet",content:`public class DataProcessor {
  // Missing 'with sharing' declaration
  public static void processData() {
    // Data processing logic
  }
}`,timestamp:new Date}]},{id:"vuln-3",orgId:"demo-org",type:"data_exposure",severity:"medium",title:"Hardcoded Credentials in Apex",description:"Sensitive credentials found hardcoded in source code",location:"IntegrationService.cls",discoveredAt:new Date,status:"open",cvssScore:6.8,businessImpact:"Credentials may be exposed to unauthorized users",remediation:"Use Custom Settings or Named Credentials",evidence:[{type:"code_snippet",content:`private static final String API_KEY = 'a1b2c3d4e5f6g7h8i9j0';
private static final String API_SECRET = 'secret_key_value_should_not_be_here';`,timestamp:new Date}]},{id:"vuln-4",orgId:"demo-org",type:"permission_escalation",severity:"high",title:"Excessive Profile Permissions",description:"Custom profile has unnecessary administrative permissions",location:"Profile: Sales Manager",discoveredAt:new Date,status:"open",cvssScore:8.2,businessImpact:"Users may have excessive privileges leading to potential data breaches",remediation:"Review and restrict profile permissions following least privilege principle",evidence:[{type:"code_snippet",content:`Profile permissions include:
- Modify All Data
- View All Data
- Manage Users
- Assign Permission Sets`,timestamp:new Date}]},{id:"vuln-5",orgId:"demo-org",type:"xss",severity:"medium",title:"Reflected XSS in Visualforce Page",description:"User input is reflected without proper encoding",location:"AccountDetails.page",discoveredAt:new Date,status:"open",cvssScore:6.1,businessImpact:"Potential cross-site scripting attacks against users",remediation:"Use HTMLENCODE() or JSENCODE() functions",evidence:[{type:"code_snippet",content:'<apex:outputText value="{!$Request.param}" escape="false"/>',timestamp:new Date}]},{id:"vuln-6",orgId:"demo-org",type:"soql_injection",severity:"critical",title:"SOQL Injection in REST API",description:"User-controlled input used directly in SOQL query",location:"AccountRESTService.cls",discoveredAt:new Date,status:"open",cvssScore:9.3,businessImpact:"Complete data exposure and potential data manipulation",remediation:"Use parameterized queries and input validation",evidence:[{type:"code_snippet",content:`@RestResource(urlMapping='/accounts/*')
global class AccountRESTService {
  @HttpGet
  global static List<Account> getAccounts() {
    String filter = RestContext.request.params.get('filter');
    return Database.query('SELECT Id, Name FROM Account WHERE ' + filter);
  }
}`,timestamp:new Date}]},{id:"vuln-7",orgId:"demo-org",type:"data_exposure",severity:"low",title:"Debug Logs Containing PII",description:"Personal identifiable information logged in debug statements",location:"UserService.cls",discoveredAt:new Date,status:"open",cvssScore:3.5,businessImpact:"PII may be exposed in logs accessible to administrators",remediation:"Remove or mask sensitive data in debug logs",evidence:[{type:"code_snippet",content:`System.debug('User email: ' + user.Email);
System.debug('SSN: ' + contact.SSN__c);`,timestamp:new Date}]}]}return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:P,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(F,{className:"w-6 h-6 text-red-600 mr-3"}),"Security Report"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive security analysis results for your Salesforce organization"})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:m,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Report"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:k.total}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Issues"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:k.critical}),e.jsx("div",{className:"text-xs text-red-600",children:"Critical"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:k.high}),e.jsx("div",{className:"text-xs text-orange-600",children:"High"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:k.medium}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Medium"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:k.low}),e.jsx("div",{className:"text-xs text-green-600",children:"Low"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:k.avgCvss.toFixed(1)}),e.jsx("div",{className:"text-xs text-blue-600",children:"Avg CVSS"})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search vulnerabilities...",value:t,onChange:c=>r(c.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full sm:w-64"})]}),e.jsxs("select",{value:n,onChange:c=>i(c.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:o,onChange:c=>l(c.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),f.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))]}),e.jsxs("select",{value:u,onChange:c=>g(c.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Classes/Components"}),S.map(c=>e.jsx("option",{value:c,children:c},c))]})]})})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Security Issues by Class/Component"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class/Component"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Critical"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"High"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Medium"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Low"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Risk Score"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.from(b.entries()).map(([c,N])=>{const I=N.filter(R=>R.severity==="critical").length,O=N.filter(R=>R.severity==="high").length,A=N.filter(R=>R.severity==="medium").length,L=N.filter(R=>R.severity==="low").length,q=N.length,H=(I*10+O*7+A*4+L*1)/(q>0?q:1);return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>g(c===u?"all":c),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:I>0?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:I}):e.jsx("span",{className:"text-gray-400",children:"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O>0?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:O}):e.jsx("span",{className:"text-gray-400",children:"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A>0?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:A}):e.jsx("span",{className:"text-gray-400",children:"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:L>0?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:L}):e.jsx("span",{className:"text-gray-400",children:"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:q}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2.5 mr-2",children:e.jsx("div",{className:`h-2.5 rounded-full ${H>7?"bg-red-600":H>5?"bg-orange-500":H>3?"bg-yellow-400":"bg-green-500"}`,style:{width:`${Math.min(100,H*10)}%`}})}),e.jsx("span",{children:H.toFixed(1)})]})})]},c)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Detailed Vulnerability Report (",v.length," issues)"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:v.map(c=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p(c.severity)}`,children:T(c.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:c.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${p(c.severity)}`,children:c.severity.toUpperCase()}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["CVSS ",c.cvssScore]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[_(c.type),e.jsx("span",{children:c.type.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase())})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{children:c.location})]})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:c.description})]})]}),e.jsxs("div",{className:"ml-12",children:[e.jsx("button",{onClick:()=>x(c.id),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:d.has(c.id)?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"Hide Details"})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Show Details"})]})}),d.has(c.id)&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-red-900 mb-2 flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Business Impact"]}),e.jsx("p",{className:"text-sm text-red-800",children:c.businessImpact})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-900 mb-2 flex items-center",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Remediation"]}),e.jsx("p",{className:"text-sm text-green-800",children:c.remediation})]}),c.evidence&&c.evidence.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Code Evidence"]}),e.jsx("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm font-mono",children:c.evidence[0].content})})]})]})]})]})})},c.id))})]}),v.length===0&&a.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(He,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Vulnerabilities Match Your Filters"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or filters to see more results."}),e.jsx("button",{onClick:()=>{i("all"),l("all"),g("all"),r("")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Clear All Filters"})]})]})};function Hr(){return e.jsx(Rs,{basename:"/TrustHuntEnt",children:e.jsxs(Ts,{children:[e.jsx(Ne,{path:"/",element:e.jsx(Fr,{})}),e.jsx(Ne,{path:"/report",element:e.jsx(zr,{})}),e.jsx(Ne,{path:"/vulnerabilities",element:e.jsx(ys,{})}),e.jsx(Ne,{path:"/scan-results",element:e.jsx(fs,{})})]})})}ze.createRoot(document.getElementById("root")).render(e.jsx(se.StrictMode,{children:e.jsx(Hr,{})}))});export default Vr();
